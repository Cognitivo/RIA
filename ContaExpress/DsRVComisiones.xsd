<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="DsRVComisiones" targetNamespace="http://tempuri.org/DsRVComisiones.xsd" xmlns:mstns="http://tempuri.org/DsRVComisiones.xsd" xmlns="http://tempuri.org/DsRVComisiones.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="MySettings" AppSettingsPropertyName="GESTIONConnectionString2" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="GESTIONConnectionString2 (MySettings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.ContaExpress.My.MySettings.GlobalReference.Default.GESTIONConnectionString2" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ComisionVendedorCobranzaTableAdapter" GeneratorDataComponentClassName="ComisionVendedorCobranzaTableAdapter" Name="ComisionVendedorCobranza" UserDataComponentName="ComisionVendedorCobranzaTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy1Vend" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetDataBy1Vend" GeneratorSourceName="FillBy1Vend" GetMethodModifier="Public" GetMethodName="GetDataBy1Vend" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetDataBy1Vend" UserSourceName="FillBy1Vend">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT TOTALCONIVACOB AS TOTALCONIVA, TOTALSINIVACOB AS TOTALSINIVA, NROCOMPROBANTE, NUMVENTA, NUMDEVOLUCION, 
                         FECHAFACT, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, 
                         NOMBREFANTASIA, CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR
FROM            (SELECT        TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, 
                                                    V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) 
                                                    AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, 
                                                    V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL 
                                                    AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, 
                                                    dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA
                          FROM            dbo.VENTAS AS V INNER JOIN
                                                    dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN
                                                    dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN
                                                    dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR
                          WHERE        (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR
                                                    V.MODALIDADPAGO = 4)
                          UNION
                          SELECT        TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) 
                                                   AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, 
                                                   NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA
                          FROM            (SELECT        TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, 
                                                                                                              @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) -
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, 
                                                                                                              @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) 
                                                                              / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, 
                                                                              VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, 
                                                                              VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, 
                                                                              VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL 
                                                                              AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, 
                                                                              CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA
                                                    FROM            dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN
                                                                              dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN
                                                                              dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN
                                                                              dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN
                                                                              dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR
                                                    WHERE        (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2
                          GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, 
                                                   NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA) 
                         AS MOVIMIENTOSCLIENTE
WHERE        (FECHACOMP &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHACOMP &lt;= CONVERT(DATETIME, @fechafin, 103)) AND (CODVENDEDOR IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@vend, ',') AS fnPartir_1))
ORDER BY FECHACOMP</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fechaini" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechaini" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fechafin" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechafin" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="vend" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@vend" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NUMVENDEDOR" DataSetColumn="NUMVENDEDOR" />
              <Mapping SourceColumn="DESVENDEDOR" DataSetColumn="DESVENDEDOR" />
              <Mapping SourceColumn="TOTALCONIVA" DataSetColumn="TOTALCONIVA" />
              <Mapping SourceColumn="TOTALSINIVA" DataSetColumn="TOTALSINIVA" />
              <Mapping SourceColumn="CODVENDEDOR" DataSetColumn="CODVENDEDOR" />
              <Mapping SourceColumn="FECHACOMP" DataSetColumn="FECHACOMP" />
              <Mapping SourceColumn="NROCOMPROBANTE" DataSetColumn="NROCOMPROBANTE" />
              <Mapping SourceColumn="NUMVENTA" DataSetColumn="NUMVENTA" />
              <Mapping SourceColumn="FECHAFACT" DataSetColumn="FECHAFACT" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="FECHAREGISTROCOB" DataSetColumn="FECHAREGISTROCOB" />
              <Mapping SourceColumn="NRORECIBO" DataSetColumn="NRORECIBO" />
              <Mapping SourceColumn="NUMCLIENTE" DataSetColumn="NUMCLIENTE" />
              <Mapping SourceColumn="NOMBRE" DataSetColumn="NOMBRE" />
              <Mapping SourceColumn="DIRECCION" DataSetColumn="DIRECCION" />
              <Mapping SourceColumn="DESCIUDAD" DataSetColumn="DESCIUDAD" />
              <Mapping SourceColumn="TELEFONO" DataSetColumn="TELEFONO" />
              <Mapping SourceColumn="CODCLIENTE" DataSetColumn="CODCLIENTE" />
              <Mapping SourceColumn="NOMBREFANTASIA" DataSetColumn="NOMBREFANTASIA" />
              <Mapping SourceColumn="NUMDEVOLUCION" DataSetColumn="NUMDEVOLUCION" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT TOTALCONIVACOB AS TOTALCONIVA, TOTALSINIVACOB AS TOTALSINIVA, NROCOMPROBANTE, NUMVENTA, NUMDEVOLUCION, 
                         FECHAFACT, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, 
                         NOMBREFANTASIA, CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR
FROM            (SELECT        TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, 
                                                    V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) 
                                                    AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, 
                                                    V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL 
                                                    AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, 
                                                    dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA
                          FROM            dbo.VENTAS AS V INNER JOIN
                                                    dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN
                                                    dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN
                                                    dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR
                          WHERE        (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR
                                                    V.MODALIDADPAGO = 4)
                          UNION
                          SELECT        TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) 
                                                   AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, 
                                                   NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA
                          FROM            (SELECT        TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, 
                                                                                                              @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) -
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, 
                                                                                                              @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) 
                                                                              / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, 
                                                                              VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, 
                                                                              VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, 
                                                                              VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL 
                                                                              AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, 
                                                                              CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA
                                                    FROM            dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN
                                                                              dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN
                                                                              dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN
                                                                              dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN
                                                                              dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR
                                                    WHERE        (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2
                          GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, 
                                                   NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA) 
                         AS MOVIMIENTOSCLIENTE
WHERE        (FECHACOMP &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHACOMP &lt;= CONVERT(DATETIME, @fechafin, 103)) 
ORDER BY FECHACOMP</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fechaini" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechaini" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fechafin" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechafin" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ComisionVendedorFacturacionTableAdapter" GeneratorDataComponentClassName="ComisionVendedorFacturacionTableAdapter" Name="ComisionVendedorFacturacion" UserDataComponentName="ComisionVendedorFacturacionTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, COMISIONPOR, SUM(DEBE) AS MONTOCONIVA, ROUND(SUM(DEBE) - SUM(IVA), 0) AS MONTOSINIVA FROM (SELECT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, dbo.VENDEDOR.COMISIONPOR, CASE dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION WHEN 1 THEN dbo.CLIENTESCUENTACORRIENTE.DEBE WHEN 2 THEN - dbo.devolucion.totalDevolucion END AS DEBE, CASE dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION WHEN 1 THEN dbo.VENTAS.TOTALIVA WHEN 2 THEN - dbo.devolucion.totalIVA END AS IVA, dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION, dbo.CLIENTESCUENTACORRIENTE.CONCEPTO FROM dbo.CLIENTESCUENTACORRIENTE INNER JOIN dbo.VENTAS ON dbo.CLIENTESCUENTACORRIENTE.CODVENTA = dbo.VENTAS.CODVENTA INNER JOIN dbo.CLIENTES ON dbo.CLIENTESCUENTACORRIENTE.CODCLIENTE = dbo.CLIENTES.CODCLIENTE AND dbo.VENTAS.CODCLIENTE = dbo.CLIENTES.CODCLIENTE INNER JOIN dbo.VENDEDOR ON dbo.VENTAS.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR LEFT OUTER JOIN dbo.DEVOLUCION ON dbo.CLIENTESCUENTACORRIENTE.CODDEVOLUCION = dbo.DEVOLUCION.CODDEVOLUCION WHERE (dbo.CLIENTESCUENTACORRIENTE.FECHACLIENTEMOV &gt;= CONVERT(DATETIME, @fdesde, 103)) AND (dbo.CLIENTESCUENTACORRIENTE.FECHACLIENTEMOV &lt;= CONVERT(DATETIME, @fhasta, 103)) AND (dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION IN (1, 2)) AND (dbo.CLIENTESCUENTACORRIENTE.CONCEPTO NOT LIKE 'Anulac%')) AS SUBCONSULTA GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, COMISIONPOR" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, MONTOCONIVA, MONTOSINIVA, COMISIONPOR +
                             (SELECT        ISNULL(PORCENTAJECOMISION, 0) AS Expr1
                               FROM            dbo.METAS
                               WHERE        (META =
                                                             (SELECT        MAX(META) AS Expr1
                                                               FROM            dbo.METAS AS METAS_1
                                                               WHERE        (META &lt;= SUBCONSULTA2.MONTOCONIVA)))) AS PORCCONIVA, COMISIONPOR +
                             (SELECT        ISNULL(PORCENTAJECOMISION, 0) AS Expr1
                               FROM            dbo.METAS AS METAS_2
                               WHERE        (META =
                                                             (SELECT        MAX(META) AS Expr1
                                                               FROM            dbo.METAS AS METAS_1
                                                               WHERE        (META &lt;= SUBCONSULTA2.MONTOSINIVA)))) AS PORCSINIVA
FROM            (SELECT        CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, COMISIONPOR, SUM(DEBE) AS MONTOCONIVA, ROUND(SUM(DEBE) - SUM(IVA), 0) 
                                                    AS MONTOSINIVA
                          FROM            (SELECT        dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, dbo.VENDEDOR.COMISIONPOR, 
                                                                              CASE dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION WHEN 1 THEN dbo.CLIENTESCUENTACORRIENTE.DEBE WHEN 2 THEN - dbo.devolucion.totalDevolucion
                                                                               END AS DEBE, 
                                                                              CASE dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION WHEN 1 THEN dbo.VENTAS.TOTALIVA WHEN 2 THEN - dbo.devolucion.totalIVA END
                                                                               AS IVA, dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION, dbo.CLIENTESCUENTACORRIENTE.CONCEPTO
                                                    FROM            dbo.CLIENTESCUENTACORRIENTE INNER JOIN
                                                                              dbo.VENTAS ON dbo.CLIENTESCUENTACORRIENTE.CODVENTA = dbo.VENTAS.CODVENTA INNER JOIN
                                                                              dbo.CLIENTES ON dbo.CLIENTESCUENTACORRIENTE.CODCLIENTE = dbo.CLIENTES.CODCLIENTE AND 
                                                                              dbo.VENTAS.CODCLIENTE = dbo.CLIENTES.CODCLIENTE INNER JOIN
                                                                              dbo.VENDEDOR ON dbo.VENTAS.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR LEFT OUTER JOIN
                                                                              dbo.DEVOLUCION ON dbo.CLIENTESCUENTACORRIENTE.CODDEVOLUCION = dbo.DEVOLUCION.CODDEVOLUCION
                                                    WHERE        (dbo.CLIENTESCUENTACORRIENTE.FECHACLIENTEMOV &gt;= CONVERT(DATETIME, 
                                                                              @fdesde, 103)) AND (dbo.CLIENTESCUENTACORRIENTE.FECHACLIENTEMOV &lt;= CONVERT(DATETIME, @fhasta, 103)) AND 
                                                                              (dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION IN (1, 2)) AND (dbo.CLIENTESCUENTACORRIENTE.CONCEPTO NOT LIKE 'Anulac%')) 
                                                    AS SUBCONSULTA
                          GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, COMISIONPOR) AS SUBCONSULTA2</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fdesde" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fdesde" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fhasta" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fhasta" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODVENDEDOR" DataSetColumn="CODVENDEDOR" />
              <Mapping SourceColumn="NUMVENDEDOR" DataSetColumn="NUMVENDEDOR" />
              <Mapping SourceColumn="DESVENDEDOR" DataSetColumn="DESVENDEDOR" />
              <Mapping SourceColumn="MONTOCONIVA" DataSetColumn="MONTOCONIVA" />
              <Mapping SourceColumn="MONTOSINIVA" DataSetColumn="MONTOSINIVA" />
              <Mapping SourceColumn="PORCCONIVA" DataSetColumn="PORCCONIVA" />
              <Mapping SourceColumn="PORCSINIVA" DataSetColumn="PORCSINIVA" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, COMISIONPOR, SUM(DEBE) AS MONTOCONIVA, ROUND(SUM(DEBE) - SUM(IVA), 0) AS MONTOSINIVA FROM (SELECT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, dbo.VENDEDOR.COMISIONPOR, CASE dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION WHEN 1 THEN dbo.CLIENTESCUENTACORRIENTE.DEBE WHEN 2 THEN - dbo.devolucion.totalDevolucion END AS DEBE, CASE dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION WHEN 1 THEN dbo.VENTAS.TOTALIVA WHEN 2 THEN - dbo.devolucion.totalIVA END AS IVA, dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION, dbo.CLIENTESCUENTACORRIENTE.CONCEPTO FROM dbo.CLIENTESCUENTACORRIENTE INNER JOIN dbo.VENTAS ON dbo.CLIENTESCUENTACORRIENTE.CODVENTA = dbo.VENTAS.CODVENTA INNER JOIN dbo.CLIENTES ON dbo.CLIENTESCUENTACORRIENTE.CODCLIENTE = dbo.CLIENTES.CODCLIENTE AND dbo.VENTAS.CODCLIENTE = dbo.CLIENTES.CODCLIENTE INNER JOIN dbo.VENDEDOR ON dbo.VENTAS.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR LEFT OUTER JOIN dbo.DEVOLUCION ON dbo.CLIENTESCUENTACORRIENTE.CODDEVOLUCION = dbo.DEVOLUCION.CODDEVOLUCION WHERE (dbo.VENDEDOR.CODVENDEDOR IN (SELECT item FROM dbo.fnPartir(@vend, ',') AS fnPartir_1)) AND (dbo.CLIENTESCUENTACORRIENTE.FECHACLIENTEMOV &gt;= CONVERT(DATETIME, @fdesde, 103)) AND (dbo.CLIENTESCUENTACORRIENTE.FECHACLIENTEMOV &lt;= CONVERT(DATETIME, @fhasta, 103)) AND (dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION IN (1, 2)) AND (dbo.CLIENTESCUENTACORRIENTE.CONCEPTO NOT LIKE 'Anulac%')) AS SUBCONSULTA GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, COMISIONPOR" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy1Vend" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy1Vend" GeneratorSourceName="FillBy1Vend" GetMethodModifier="Public" GetMethodName="GetDataBy1Vend" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy1Vend" UserSourceName="FillBy1Vend">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, MONTOCONIVA, MONTOSINIVA, COMISIONPOR +
                             (SELECT        ISNULL(PORCENTAJECOMISION, 0) AS Expr1
                               FROM            dbo.METAS
                               WHERE        (META =
                                                             (SELECT        MAX(META) AS Expr1
                                                               FROM            dbo.METAS AS METAS_1
                                                               WHERE        (META &lt;= SUBCONSULTA2.MONTOCONIVA)))) AS PORCCONIVA, COMISIONPOR +
                             (SELECT        ISNULL(PORCENTAJECOMISION, 0) AS Expr1
                               FROM            dbo.METAS AS METAS_2
                               WHERE        (META =
                                                             (SELECT        MAX(META) AS Expr1
                                                               FROM            dbo.METAS AS METAS_1
                                                               WHERE        (META &lt;= SUBCONSULTA2.MONTOSINIVA)))) AS PORCSINIVA
FROM            (SELECT        CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, COMISIONPOR, SUM(DEBE) AS MONTOCONIVA, ROUND(SUM(DEBE) - SUM(IVA), 0) 
                                                    AS MONTOSINIVA
                          FROM            (SELECT        dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, dbo.VENDEDOR.COMISIONPOR, 
                                                                              CASE dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION WHEN 1 THEN dbo.CLIENTESCUENTACORRIENTE.DEBE WHEN 2 THEN - dbo.devolucion.totalDevolucion
                                                                               END AS DEBE, 
                                                                              CASE dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION WHEN 1 THEN dbo.VENTAS.TOTALIVA WHEN 2 THEN - dbo.devolucion.totalIVA END
                                                                               AS IVA, dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION, dbo.CLIENTESCUENTACORRIENTE.CONCEPTO
                                                    FROM            dbo.CLIENTESCUENTACORRIENTE INNER JOIN
                                                                              dbo.VENTAS ON dbo.CLIENTESCUENTACORRIENTE.CODVENTA = dbo.VENTAS.CODVENTA INNER JOIN
                                                                              dbo.CLIENTES ON dbo.CLIENTESCUENTACORRIENTE.CODCLIENTE = dbo.CLIENTES.CODCLIENTE AND 
                                                                              dbo.VENTAS.CODCLIENTE = dbo.CLIENTES.CODCLIENTE INNER JOIN
                                                                              dbo.VENDEDOR ON dbo.VENTAS.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR LEFT OUTER JOIN
                                                                              dbo.DEVOLUCION ON dbo.CLIENTESCUENTACORRIENTE.CODDEVOLUCION = dbo.DEVOLUCION.CODDEVOLUCION
                                                    WHERE        (dbo.VENDEDOR.CODVENDEDOR IN
                                                                                  (SELECT        item
                                                                                    FROM            dbo.fnPartir(@vend, ',') AS fnPartir_1)) AND (dbo.CLIENTESCUENTACORRIENTE.FECHACLIENTEMOV &gt;= CONVERT(DATETIME, 
                                                                              @fdesde, 103)) AND (dbo.CLIENTESCUENTACORRIENTE.FECHACLIENTEMOV &lt;= CONVERT(DATETIME, @fhasta, 103)) AND 
                                                                              (dbo.CLIENTESCUENTACORRIENTE.IDTRANSACCION IN (1, 2)) AND (dbo.CLIENTESCUENTACORRIENTE.CONCEPTO NOT LIKE 'Anulac%')) 
                                                    AS SUBCONSULTA
                          GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, COMISIONPOR) AS SUBCONSULTA2</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fdesde" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fdesde" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fhasta" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fhasta" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="vend" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@vend" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ComisionVendedorCobrDetTableAdapter" GeneratorDataComponentClassName="ComisionVendedorCobrDetTableAdapter" Name="ComisionVendedorCobrDet" UserDataComponentName="ComisionVendedorCobrDetTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT,CASE WHEN V.MODALIDADPAGO=0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT TOTALCONIVACOB AS TOTALCONIVA, TOTALSINIVACOB AS TOTALSINIVA, NROCOMPROBANTE, NUMVENTA, NUMDEVOLUCION, 
                         FECHAFACT, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, 
                         NOMBREFANTASIA, CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR
FROM            (SELECT        TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, 
                                                    V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) 
                                                    AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, 
                                                    V.FECHAVENTA AS FECHAFACT,CASE WHEN V.MODALIDADPAGO=0 then  'VTA_CONT' else 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, 
                                                    dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, 
                                                    V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA
                          FROM            dbo.VENTAS AS V INNER JOIN
                                                    dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN
                                                    dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN
                                                    dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR
                          WHERE        (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4)
                          UNION
                          SELECT        TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) 
                                                   AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, 
                                                   NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA
                          FROM            (SELECT        TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, 
                                                                                                              @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) -
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, 
                                                                                                              @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) 
                                                                              / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, 
                                                                              VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, 
                                                                              VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, 
                                                                              VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL 
                                                                              AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, 
                                                                              CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA
                                                    FROM            dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN
                                                                              dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN
                                                                              dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN
                                                                              dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN
                                                                              dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR
                                                    WHERE        (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2
                          GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, 
                                                   NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA) 
                         AS MOVIMIENTOSCLIENTE
WHERE        (FECHACOMP &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHACOMP &lt;= CONVERT(DATETIME, @fechafin, 103))
ORDER BY TIPO DESC, NROCOMPROBANTE</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fechaini" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT,CASE WHEN V.MODALIDADPAGO=0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechaini" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fechafin" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT,CASE WHEN V.MODALIDADPAGO=0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechafin" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NUMVENDEDOR" DataSetColumn="NUMVENDEDOR" />
              <Mapping SourceColumn="DESVENDEDOR" DataSetColumn="DESVENDEDOR" />
              <Mapping SourceColumn="NUMVENTA" DataSetColumn="NUMVENTA" />
              <Mapping SourceColumn="FECHAREGISTROCOB" DataSetColumn="FECHAREGISTROCOB" />
              <Mapping SourceColumn="NRORECIBO" DataSetColumn="NRORECIBO" />
              <Mapping SourceColumn="NOMBREFANTASIA" DataSetColumn="NOMBREFANTASIA" />
              <Mapping SourceColumn="TOTALCONIVA" DataSetColumn="TOTALCONIVA" />
              <Mapping SourceColumn="TOTALSINIVA" DataSetColumn="TOTALSINIVA" />
              <Mapping SourceColumn="NROCOMPROBANTE" DataSetColumn="NROCOMPROBANTE" />
              <Mapping SourceColumn="FECHAFACT" DataSetColumn="FECHAFACT" />
              <Mapping SourceColumn="FECHACOMP" DataSetColumn="FECHACOMP" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="NUMCLIENTE" DataSetColumn="NUMCLIENTE" />
              <Mapping SourceColumn="NOMBRE" DataSetColumn="NOMBRE" />
              <Mapping SourceColumn="DIRECCION" DataSetColumn="DIRECCION" />
              <Mapping SourceColumn="DESCIUDAD" DataSetColumn="DESCIUDAD" />
              <Mapping SourceColumn="TELEFONO" DataSetColumn="TELEFONO" />
              <Mapping SourceColumn="CODCLIENTE" DataSetColumn="CODCLIENTE" />
              <Mapping SourceColumn="NUMDEVOLUCION" DataSetColumn="NUMDEVOLUCION" />
              <Mapping SourceColumn="CODVENDEDOR" DataSetColumn="CODVENDEDOR1" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy1Vend" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy1Vend" GeneratorSourceName="FillBy1Vend" GetMethodModifier="Public" GetMethodName="GetDataBy1Vend" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy1Vend" UserSourceName="FillBy1Vend">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT TOTALCONIVACOB AS TOTALCONIVA, TOTALSINIVACOB AS TOTALSINIVA, NROCOMPROBANTE, NUMVENTA, NUMDEVOLUCION, FECHAFACT, FECHACOMP, TIPO, FECHAREGISTROCOB, 
                         NRORECIBO, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR
FROM            (SELECT        TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, 
                                                    V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, 
                                                    V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL 
                                                    AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, 
                                                    dbo.CLIENTES.NOMBREFANTASIA
                          FROM            dbo.VENTAS AS V INNER JOIN
                                                    dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN
                                                    dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN
                                                    dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR
                          WHERE        (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0)
                          UNION
                          SELECT        TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL 
                                                   AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, 
                                                   NOMBREFANTASIA
                          FROM            (SELECT        TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO
                                                                                    WHERE        (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) 
                                                                              -
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3
                                                                                    WHERE        (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) 
                                                                              / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2
                                                                                    WHERE        (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, 
                                                                              VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, 
                                                                              VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, 
                                                                              CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA
                                                    FROM            dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN
                                                                              dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN
                                                                              dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN
                                                                              dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN
                                                                              dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR
                                                    WHERE        (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2
                          GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, 
                                                   DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA) AS MOVIMIENTOSCLIENTE
WHERE        (FECHACOMP &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHACOMP &lt;= CONVERT(DATETIME, @fechafin, 103)) AND (CODVENDEDOR IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@vend, ',') AS fnPartir_1))
ORDER BY TIPO DESC, NROCOMPROBANTE</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fechaini" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechaini" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fechafin" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechafin" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="vend" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@vend" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ComisionVendedorCobranzaTipoVentaTableAdapter" GeneratorDataComponentClassName="ComisionVendedorCobranzaTipoVentaTableAdapter" Name="ComisionVendedorCobranzaTipoVenta" UserDataComponentName="ComisionVendedorCobranzaTipoVentaTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT TOTALCONIVACOB AS TOTALCONIVA, TOTALSINIVACOB AS TOTALSINIVA, NROCOMPROBANTE, NUMVENTA, NUMDEVOLUCION, FECHAFACT, 
                         FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, 
                         MODALIDADPAGO, CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR
FROM            (SELECT        TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, 
                                                    V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) 
                                                    AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, 
                                                    V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL 
                                                    AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, 
                                                    dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA, 
                                                    V.MODALIDADPAGO
                          FROM            dbo.VENTAS AS V INNER JOIN
                                                    dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN
                                                    dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN
                                                    dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR
                          WHERE        (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR
                                                    V.MODALIDADPAGO = 4)
                          UNION
                          SELECT        TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) 
                                                   AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, 
                                                   NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO
                          FROM            (SELECT        TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 
                                                                                                              103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) -
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 
                                                                                                              103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) 
                                                                              / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, 
                                                                              VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, 
                                                                              VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, 
                                                                              VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, 
                                                                              CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, 
                                                                              V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA, V.MODALIDADPAGO
                                                    FROM            dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN
                                                                              dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN
                                                                              dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN
                                                                              dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN
                                                                              dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR
                                                    WHERE        (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2
                          GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, 
                                                   NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO) AS MOVIMIENTOSCLIENTE
WHERE        (FECHACOMP &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHACOMP &lt;= CONVERT(DATETIME, @fechafin, 103))
ORDER BY FECHACOMP</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fechaini" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechaini" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fechafin" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechafin" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="TOTALCONIVA" DataSetColumn="TOTALCONIVA" />
              <Mapping SourceColumn="TOTALSINIVA" DataSetColumn="TOTALSINIVA" />
              <Mapping SourceColumn="NROCOMPROBANTE" DataSetColumn="NROCOMPROBANTE" />
              <Mapping SourceColumn="NUMVENTA" DataSetColumn="NUMVENTA" />
              <Mapping SourceColumn="NUMDEVOLUCION" DataSetColumn="NUMDEVOLUCION" />
              <Mapping SourceColumn="FECHAFACT" DataSetColumn="FECHAFACT" />
              <Mapping SourceColumn="FECHACOMP" DataSetColumn="FECHACOMP" />
              <Mapping SourceColumn="TIPO" DataSetColumn="TIPO" />
              <Mapping SourceColumn="FECHAREGISTROCOB" DataSetColumn="FECHAREGISTROCOB" />
              <Mapping SourceColumn="NRORECIBO" DataSetColumn="NRORECIBO" />
              <Mapping SourceColumn="NUMCLIENTE" DataSetColumn="NUMCLIENTE" />
              <Mapping SourceColumn="NOMBRE" DataSetColumn="NOMBRE" />
              <Mapping SourceColumn="DIRECCION" DataSetColumn="DIRECCION" />
              <Mapping SourceColumn="DESCIUDAD" DataSetColumn="DESCIUDAD" />
              <Mapping SourceColumn="TELEFONO" DataSetColumn="TELEFONO" />
              <Mapping SourceColumn="CODCLIENTE" DataSetColumn="CODCLIENTE" />
              <Mapping SourceColumn="NOMBREFANTASIA" DataSetColumn="NOMBREFANTASIA" />
              <Mapping SourceColumn="MODALIDADPAGO" DataSetColumn="MODALIDADPAGO" />
              <Mapping SourceColumn="CODVENDEDOR" DataSetColumn="CODVENDEDOR" />
              <Mapping SourceColumn="NUMVENDEDOR" DataSetColumn="NUMVENDEDOR" />
              <Mapping SourceColumn="DESVENDEDOR" DataSetColumn="DESVENDEDOR" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy" GeneratorSourceName="FillBy" GetMethodModifier="Public" GetMethodName="GetDataBy" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy" UserSourceName="FillBy">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT TOTALCONIVACOB AS TOTALCONIVA, TOTALSINIVACOB AS TOTALSINIVA, NROCOMPROBANTE, NUMVENTA, NUMDEVOLUCION, FECHAFACT, 
                         FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, 
                         MODALIDADPAGO, CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR
FROM            (SELECT        TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, 
                                                    V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) 
                                                    AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, 
                                                    V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL 
                                                    AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, 
                                                    dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA, 
                                                    V.MODALIDADPAGO
                          FROM            dbo.VENTAS AS V INNER JOIN
                                                    dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN
                                                    dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN
                                                    dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR
                          WHERE        (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR
                                                    V.MODALIDADPAGO = 4)
                          UNION
                          SELECT        TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) 
                                                   AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, 
                                                   NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO
                          FROM            (SELECT        TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 
                                                                                                              103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) -
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 
                                                                                                              103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) 
                                                                              / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB,
                                                                                  (SELECT        SUM(IMPORTE) AS Expr1
                                                                                    FROM            dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2
                                                                                    WHERE        (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, 
                                                                              VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, 
                                                                              VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, 
                                                                              VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, 
                                                                              CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, 
                                                                              V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA, V.MODALIDADPAGO
                                                    FROM            dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN
                                                                              dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN
                                                                              dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN
                                                                              dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN
                                                                              dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR
                                                    WHERE        (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2
                          GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, 
                                                   NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO) AS MOVIMIENTOSCLIENTE
WHERE        (FECHACOMP &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHACOMP &lt;= CONVERT(DATETIME, @fechafin, 103)) AND (CODVENDEDOR IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@vend, ',') AS fnPartir_1))
ORDER BY DESVENDEDOR</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fechaini" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechaini" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fechafin" ColumnName="FECHACOMP" DataSourceName="SELECT TOP (100) PERCENT dbo.VENDEDOR.CODVENDEDOR, dbo.VENDEDOR.NUMVENDEDOR, dbo.VENDEDOR.DESVENDEDOR, V.TOTALVENTA - V.TOTALIVA AS TOTALSINIVACOB, V.TOTALVENTA AS TOTALCONIVACOB, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NROCOMPROBANTE, SUBSTRING(V.NUMVENTA, 9, LEN(V.NUMVENTA) - 7) AS NUMVENTA, V.FECHAVENTA AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, CASE WHEN V.MODALIDADPAGO = 0 THEN 'VTA_CONT' ELSE 'VTA_OTROS' END AS TIPO, NULL AS FECHAREGISTROCOB, NULL AS NRORECIBO, NULL AS NUMDEVOLUCION, dbo.CLIENTES.NUMCLIENTE, dbo.CLIENTES.NOMBRE, dbo.CLIENTES.DIRECCION, dbo.CIUDAD.DESCIUDAD, dbo.CLIENTES.TELEFONO, V.CODCLIENTE, dbo.CLIENTES.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTAS AS V INNER JOIN dbo.CLIENTES ON V.CODCLIENTE = dbo.CLIENTES.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD ON dbo.CLIENTES.CODCIUDAD = dbo.CIUDAD.CODCIUDAD INNER JOIN dbo.VENDEDOR ON V.CODVENDEDOR = dbo.VENDEDOR.CODVENDEDOR WHERE (V.ESTADO = 1) AND (V.MODALIDADPAGO = 0 OR V.MODALIDADPAGO = 4) UNION SELECT TOP (100) PERCENT CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, SUM(TOTALSINIVACOB) AS TOTALSINIVA, SUM(TOTALCONIVACOB) AS TOTALCONIVA, NROCOMPROBANTE, NULL AS NUMVENTA, FECHACOMP, NULL AS FECHAFACT, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO FROM (SELECT TOP (100) PERCENT VENDEDOR_3.CODVENDEDOR, VENDEDOR_3.NUMVENDEDOR, VENDEDOR_3.DESVENDEDOR, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) - (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_3 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA) AND (FECHAREGISTROCOB &gt;= CONVERT(DATETIME, @fechaini, 103)) AND (FECHAREGISTROCOB &lt;= CONVERT(DATETIME, @fechafin, 103))) / V.TOTALVENTA * V.TOTALIVA AS TOTALSINIVACOB, (SELECT SUM(IMPORTE) AS Expr1 FROM dbo.VENTASFORMACOBRO AS VENTASFORMACOBRO_2 WHERE (CODTIPOCOBRO &lt;&gt; 5) AND (CODVENTA = V.CODVENTA)) AS TOTALCONIVACOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NROCOMPROBANTE, V.NUMVENTA, VFCORIG.FECHAREGISTROCOB AS FECHACOMP, V.FECHAVENTA AS FECHAFACT, 'RECIBO' AS TIPO, VFCORIG.FECHAREGISTROCOB, VFCORIG.NRORECIBO + ' ' + ISNULL(VFCORIG.RECIBONROSERIE, '') AS NRORECIBO, NULL AS NUMDEVOLUCION, CLIENTES_2.NUMCLIENTE, CLIENTES_2.NOMBRE, CLIENTES_2.DIRECCION, CIUDAD_2.DESCIUDAD, CLIENTES_2.TELEFONO, V.CODCLIENTE, CLIENTES_2.NOMBREFANTASIA, V.MODALIDADPAGO FROM dbo.VENTASFORMACOBRO AS VFCORIG INNER JOIN dbo.VENTAS AS V ON V.CODVENTA = VFCORIG.CODVENTA INNER JOIN dbo.CLIENTES AS CLIENTES_2 ON V.CODCLIENTE = CLIENTES_2.CODCLIENTE LEFT OUTER JOIN dbo.CIUDAD AS CIUDAD_2 ON CLIENTES_2.CODCIUDAD = CIUDAD_2.CODCIUDAD INNER JOIN dbo.VENDEDOR AS VENDEDOR_3 ON V.CODVENDEDOR = VENDEDOR_3.CODVENDEDOR WHERE (VFCORIG.CODTIPOCOBRO &lt;&gt; 5) AND (V.ESTADO = 1)) AS dt2 GROUP BY CODVENDEDOR, NUMVENDEDOR, DESVENDEDOR, NROCOMPROBANTE, FECHACOMP, TIPO, FECHAREGISTROCOB, NRORECIBO, NUMDEVOLUCION, NUMCLIENTE, NOMBRE, DIRECCION, DESCIUDAD, TELEFONO, CODCLIENTE, NOMBREFANTASIA, MODALIDADPAGO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechafin" Precision="0" Scale="0" Size="8" SourceColumn="FECHACOMP" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="vend" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@vend" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="ComisionNotasCreditoTableAdapter" GeneratorDataComponentClassName="ComisionNotasCreditoTableAdapter" Name="ComisionNotasCredito" UserDataComponentName="ComisionNotasCreditoTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillNC2" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetDataNC2" GeneratorSourceName="FillNC2" GetMethodModifier="Public" GetMethodName="GetDataNC2" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetDataNC2" UserSourceName="FillNC2">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        VENTASFORMACOBRO.CODTIPOCOBRO, DEVOLUCION.TOTALDEVOLUCION - DEVOLUCION.TOTALIVA AS importesiniva, VENTASFORMACOBRO.DESTIPOCOBRO, VENTASFORMACOBRO.FECHACOBRO, 
                         VENDEDOR.CODVENDEDOR, VENTASFORMACOBRO.NUMDEVOLUCION, VENTASFORMACOBRO.NRORECIBO, CLIENTES.NOMBRE, CLIENTES.NOMBREFANTASIA, VENTAS.NUMVENTA, 
                         VENDEDOR.DESVENDEDOR
FROM            VENTASFORMACOBRO INNER JOIN
                         VENTAS ON VENTASFORMACOBRO.CODVENTA = VENTAS.CODVENTA INNER JOIN
                         VENDEDOR ON VENTAS.CODVENDEDOR = VENDEDOR.CODVENDEDOR INNER JOIN
                         CLIENTES ON VENTAS.CODCLIENTE = CLIENTES.CODCLIENTE INNER JOIN
                         DEVOLUCION ON VENTASFORMACOBRO.NUMDEVOLUCION = DEVOLUCION.NUMDEVOLUCION
GROUP BY VENTASFORMACOBRO.CODTIPOCOBRO, VENTASFORMACOBRO.IMPORTE, VENTASFORMACOBRO.DESTIPOCOBRO, VENTASFORMACOBRO.FECHACOBRO, VENDEDOR.CODVENDEDOR, 
                         VENTASFORMACOBRO.NUMDEVOLUCION, VENTASFORMACOBRO.NRORECIBO, CLIENTES.NOMBRE, CLIENTES.NOMBREFANTASIA, VENTAS.NUMVENTA, VENDEDOR.DESVENDEDOR, 
                         DEVOLUCION.TOTALDEVOLUCION - DEVOLUCION.TOTALIVA
HAVING        (VENDEDOR.CODVENDEDOR =
                             (SELECT        item
                               FROM            dbo.fnPartir(@vend, ',') AS fnPartir_1)) AND (VENTASFORMACOBRO.CODTIPOCOBRO = 5) AND (VENTASFORMACOBRO.FECHACOBRO &gt;= CONVERT(DATETIME, @fechaini, 103)) AND 
                         (VENTASFORMACOBRO.FECHACOBRO &lt;= CONVERT(DATETIME, @fechafin, 103)) AND (VENTASFORMACOBRO.NRORECIBO &lt;&gt; '""')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fechaini" ColumnName="FECHACOBRO" DataSourceName="Fipar.dbo.VENTASFORMACOBRO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechaini" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHACOBRO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fechafin" ColumnName="FECHACOBRO" DataSourceName="Fipar.dbo.VENTASFORMACOBRO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechafin" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHACOBRO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="vend" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@vend" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="NUMDEVOLUCION" DataSetColumn="NUMDEVOLUCION" />
              <Mapping SourceColumn="NOMBRE" DataSetColumn="NOMBRE" />
              <Mapping SourceColumn="CODVENDEDOR" DataSetColumn="CODVENDEDOR" />
              <Mapping SourceColumn="CODTIPOCOBRO" DataSetColumn="CODTIPOCOBRO" />
              <Mapping SourceColumn="DESTIPOCOBRO" DataSetColumn="DESTIPOCOBRO" />
              <Mapping SourceColumn="FECHACOBRO" DataSetColumn="FECHACOBRO" />
              <Mapping SourceColumn="NRORECIBO" DataSetColumn="NRORECIBO" />
              <Mapping SourceColumn="NOMBREFANTASIA" DataSetColumn="NOMBREFANTASIA" />
              <Mapping SourceColumn="NUMVENTA" DataSetColumn="NUMVENTA" />
              <Mapping SourceColumn="DESVENDEDOR" DataSetColumn="DESVENDEDOR" />
              <Mapping SourceColumn="importesiniva" DataSetColumn="importesiniva" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillNC" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataNC" GeneratorSourceName="FillNC" GetMethodModifier="Public" GetMethodName="GetDataNC" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataNC" UserSourceName="FillNC">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        VENTASFORMACOBRO.CODTIPOCOBRO, DEVOLUCION.TOTALDEVOLUCION - DEVOLUCION.TOTALIVA AS importesiniva, VENTASFORMACOBRO.DESTIPOCOBRO, VENTASFORMACOBRO.FECHACOBRO, 
                         VENDEDOR.CODVENDEDOR, VENTASFORMACOBRO.NUMDEVOLUCION, VENTASFORMACOBRO.NRORECIBO, CLIENTES.NOMBRE, CLIENTES.NOMBREFANTASIA, VENTAS.NUMVENTA, 
                         VENDEDOR.DESVENDEDOR
FROM            VENTASFORMACOBRO INNER JOIN
                         VENTAS ON VENTASFORMACOBRO.CODVENTA = VENTAS.CODVENTA INNER JOIN
                         VENDEDOR ON VENTAS.CODVENDEDOR = VENDEDOR.CODVENDEDOR INNER JOIN
                         CLIENTES ON VENTAS.CODCLIENTE = CLIENTES.CODCLIENTE INNER JOIN
                         DEVOLUCION ON VENTASFORMACOBRO.NUMDEVOLUCION = DEVOLUCION.NUMDEVOLUCION
GROUP BY VENTASFORMACOBRO.CODTIPOCOBRO, VENTASFORMACOBRO.IMPORTE, VENTASFORMACOBRO.DESTIPOCOBRO, VENTASFORMACOBRO.FECHACOBRO, VENDEDOR.CODVENDEDOR, 
                         VENTASFORMACOBRO.NUMDEVOLUCION, VENTASFORMACOBRO.NRORECIBO, CLIENTES.NOMBRE, CLIENTES.NOMBREFANTASIA, VENTAS.NUMVENTA, VENDEDOR.DESVENDEDOR, 
                         DEVOLUCION.TOTALDEVOLUCION - DEVOLUCION.TOTALIVA
HAVING        (VENDEDOR.CODVENDEDOR =
                             (SELECT        item
                               FROM            dbo.fnPartir(@vend, ',') AS fnPartir_1)) AND (VENTASFORMACOBRO.CODTIPOCOBRO = 5) AND (VENTASFORMACOBRO.FECHACOBRO &gt;= CONVERT(DATETIME, @fechaini, 103)) AND 
                         (VENTASFORMACOBRO.FECHACOBRO &lt;= CONVERT(DATETIME, @fechafin, 103)) AND (VENTASFORMACOBRO.NRORECIBO &lt;&gt; '""')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fechaini" ColumnName="FECHACOBRO" DataSourceName="Fipar.dbo.VENTASFORMACOBRO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechaini" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHACOBRO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fechafin" ColumnName="FECHACOBRO" DataSourceName="Fipar.dbo.VENTASFORMACOBRO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechafin" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHACOBRO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="vend" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@vend" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillNCTodos" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataNCTodos" GeneratorSourceName="FillNCTodos" GetMethodModifier="Public" GetMethodName="GetDataNCTodos" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataNCTodos" UserSourceName="FillNCTodos">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        VENTASFORMACOBRO.CODTIPOCOBRO, VENTASFORMACOBRO.IMPORTE, VENTASFORMACOBRO.DESTIPOCOBRO, VENTASFORMACOBRO.FECHACOBRO, VENDEDOR.CODVENDEDOR, 
                         VENTASFORMACOBRO.NUMDEVOLUCION, VENTASFORMACOBRO.NRORECIBO, CLIENTES.NOMBRE, CLIENTES.NOMBREFANTASIA
FROM            VENTASFORMACOBRO INNER JOIN
                         VENTAS ON VENTASFORMACOBRO.CODVENTA = VENTAS.CODVENTA INNER JOIN
                         VENDEDOR ON VENTAS.CODVENDEDOR = VENDEDOR.CODVENDEDOR INNER JOIN
                         CLIENTES ON VENTAS.CODCLIENTE = CLIENTES.CODCLIENTE
WHERE         (VENTASFORMACOBRO.CODTIPOCOBRO = 5) AND (VENTASFORMACOBRO.FECHACOBRO &gt;= CONVERT(DATETIME, @fechaini, 103)) AND 
                         (VENTASFORMACOBRO.FECHACOBRO &lt;= CONVERT(DATETIME, @fechafin, 103))</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="fechaini" ColumnName="FECHACOBRO" DataSourceName="Fipar.dbo.VENTASFORMACOBRO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechaini" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHACOBRO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="fechafin" ColumnName="FECHACOBRO" DataSourceName="Fipar.dbo.VENTASFORMACOBRO" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@fechafin" Precision="0" ProviderType="DateTime" Scale="0" Size="8" SourceColumn="FECHACOBRO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="DsRVComisiones" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msdata:EnforceConstraints="False" msprop:EnableTableAdapterManager="True" msprop:Generator_DataSetName="DsRVComisiones" msprop:Generator_UserDSName="DsRVComisiones">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="ComisionVendedorCobranza" msprop:Generator_TableClassName="ComisionVendedorCobranzaDataTable" msprop:Generator_TableVarName="tableComisionVendedorCobranza" msprop:Generator_TablePropName="ComisionVendedorCobranza" msprop:Generator_RowDeletingName="ComisionVendedorCobranzaRowDeleting" msprop:Generator_RowChangingName="ComisionVendedorCobranzaRowChanging" msprop:Generator_RowEvHandlerName="ComisionVendedorCobranzaRowChangeEventHandler" msprop:Generator_RowDeletedName="ComisionVendedorCobranzaRowDeleted" msprop:Generator_UserTableName="ComisionVendedorCobranza" msprop:Generator_RowChangedName="ComisionVendedorCobranzaRowChanged" msprop:Generator_RowEvArgName="ComisionVendedorCobranzaRowChangeEvent" msprop:Generator_RowClassName="ComisionVendedorCobranzaRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODVENDEDOR" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnCODVENDEDOR" msprop:Generator_ColumnPropNameInRow="CODVENDEDOR" msprop:Generator_ColumnPropNameInTable="CODVENDEDORColumn" msprop:Generator_UserColumnName="CODVENDEDOR" type="xs:int" />
              <xs:element name="NUMVENDEDOR" msprop:Generator_ColumnVarNameInTable="columnNUMVENDEDOR" msprop:Generator_ColumnPropNameInRow="NUMVENDEDOR" msprop:Generator_ColumnPropNameInTable="NUMVENDEDORColumn" msprop:Generator_UserColumnName="NUMVENDEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESVENDEDOR" msprop:Generator_ColumnVarNameInTable="columnDESVENDEDOR" msprop:Generator_ColumnPropNameInRow="DESVENDEDOR" msprop:Generator_ColumnPropNameInTable="DESVENDEDORColumn" msprop:Generator_UserColumnName="DESVENDEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TOTALCONIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTALCONIVA" msprop:Generator_ColumnPropNameInRow="TOTALCONIVA" msprop:Generator_ColumnPropNameInTable="TOTALCONIVAColumn" msprop:Generator_UserColumnName="TOTALCONIVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTALSINIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTALSINIVA" msprop:Generator_ColumnPropNameInRow="TOTALSINIVA" msprop:Generator_ColumnPropNameInTable="TOTALSINIVAColumn" msprop:Generator_UserColumnName="TOTALSINIVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="FECHACOMP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHACOMP" msprop:Generator_ColumnPropNameInRow="FECHACOMP" msprop:Generator_ColumnPropNameInTable="FECHACOMPColumn" msprop:Generator_UserColumnName="FECHACOMP" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NROCOMPROBANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNROCOMPROBANTE" msprop:Generator_ColumnPropNameInRow="NROCOMPROBANTE" msprop:Generator_ColumnPropNameInTable="NROCOMPROBANTEColumn" msprop:Generator_UserColumnName="NROCOMPROBANTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMVENTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMVENTA" msprop:Generator_ColumnPropNameInRow="NUMVENTA" msprop:Generator_ColumnPropNameInTable="NUMVENTAColumn" msprop:Generator_UserColumnName="NUMVENTA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="20" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHAFACT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHAFACT" msprop:Generator_ColumnPropNameInRow="FECHAFACT" msprop:Generator_ColumnPropNameInTable="FECHAFACTColumn" msprop:Generator_UserColumnName="FECHAFACT" type="xs:dateTime" minOccurs="0" />
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="15" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHAREGISTROCOB" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHAREGISTROCOB" msprop:Generator_ColumnPropNameInRow="FECHAREGISTROCOB" msprop:Generator_ColumnPropNameInTable="FECHAREGISTROCOBColumn" msprop:Generator_UserColumnName="FECHAREGISTROCOB" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NRORECIBO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNRORECIBO" msprop:Generator_ColumnPropNameInRow="NRORECIBO" msprop:Generator_ColumnPropNameInTable="NRORECIBOColumn" msprop:Generator_UserColumnName="NRORECIBO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="500" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMCLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMCLIENTE" msprop:Generator_ColumnPropNameInRow="NUMCLIENTE" msprop:Generator_ColumnPropNameInTable="NUMCLIENTEColumn" msprop:Generator_UserColumnName="NUMCLIENTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="NOMBRE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE" msprop:Generator_ColumnPropNameInRow="NOMBRE" msprop:Generator_ColumnPropNameInTable="NOMBREColumn" msprop:Generator_UserColumnName="NOMBRE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DIRECCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIRECCION" msprop:Generator_ColumnPropNameInRow="DIRECCION" msprop:Generator_ColumnPropNameInTable="DIRECCIONColumn" msprop:Generator_UserColumnName="DIRECCION" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESCIUDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCIUDAD" msprop:Generator_ColumnPropNameInRow="DESCIUDAD" msprop:Generator_ColumnPropNameInTable="DESCIUDADColumn" msprop:Generator_UserColumnName="DESCIUDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TELEFONO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTELEFONO" msprop:Generator_ColumnPropNameInRow="TELEFONO" msprop:Generator_ColumnPropNameInTable="TELEFONOColumn" msprop:Generator_UserColumnName="TELEFONO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODCLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODCLIENTE" msprop:Generator_ColumnPropNameInRow="CODCLIENTE" msprop:Generator_ColumnPropNameInTable="CODCLIENTEColumn" msprop:Generator_UserColumnName="CODCLIENTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="NOMBREFANTASIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBREFANTASIA" msprop:Generator_ColumnPropNameInRow="NOMBREFANTASIA" msprop:Generator_ColumnPropNameInTable="NOMBREFANTASIAColumn" msprop:Generator_UserColumnName="NOMBREFANTASIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMDEVOLUCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMDEVOLUCION" msprop:Generator_ColumnPropNameInRow="NUMDEVOLUCION" msprop:Generator_ColumnPropNameInTable="NUMDEVOLUCIONColumn" msprop:Generator_UserColumnName="NUMDEVOLUCION" type="xs:int" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ComisionVendedorFacturacion" msprop:Generator_TableClassName="ComisionVendedorFacturacionDataTable" msprop:Generator_TableVarName="tableComisionVendedorFacturacion" msprop:Generator_TablePropName="ComisionVendedorFacturacion" msprop:Generator_RowDeletingName="ComisionVendedorFacturacionRowDeleting" msprop:Generator_RowChangingName="ComisionVendedorFacturacionRowChanging" msprop:Generator_RowEvHandlerName="ComisionVendedorFacturacionRowChangeEventHandler" msprop:Generator_RowDeletedName="ComisionVendedorFacturacionRowDeleted" msprop:Generator_UserTableName="ComisionVendedorFacturacion" msprop:Generator_RowChangedName="ComisionVendedorFacturacionRowChanged" msprop:Generator_RowEvArgName="ComisionVendedorFacturacionRowChangeEvent" msprop:Generator_RowClassName="ComisionVendedorFacturacionRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODVENDEDOR" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnCODVENDEDOR" msprop:Generator_ColumnPropNameInRow="CODVENDEDOR" msprop:Generator_ColumnPropNameInTable="CODVENDEDORColumn" msprop:Generator_UserColumnName="CODVENDEDOR" type="xs:int" />
              <xs:element name="NUMVENDEDOR" msprop:Generator_ColumnVarNameInTable="columnNUMVENDEDOR" msprop:Generator_ColumnPropNameInRow="NUMVENDEDOR" msprop:Generator_ColumnPropNameInTable="NUMVENDEDORColumn" msprop:Generator_UserColumnName="NUMVENDEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESVENDEDOR" msprop:Generator_ColumnVarNameInTable="columnDESVENDEDOR" msprop:Generator_ColumnPropNameInRow="DESVENDEDOR" msprop:Generator_ColumnPropNameInTable="DESVENDEDORColumn" msprop:Generator_UserColumnName="DESVENDEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MONTOCONIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMONTOCONIVA" msprop:Generator_ColumnPropNameInRow="MONTOCONIVA" msprop:Generator_ColumnPropNameInTable="MONTOCONIVAColumn" msprop:Generator_UserColumnName="MONTOCONIVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="MONTOSINIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMONTOSINIVA" msprop:Generator_ColumnPropNameInRow="MONTOSINIVA" msprop:Generator_ColumnPropNameInTable="MONTOSINIVAColumn" msprop:Generator_UserColumnName="MONTOSINIVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORCCONIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORCCONIVA" msprop:Generator_ColumnPropNameInRow="PORCCONIVA" msprop:Generator_ColumnPropNameInTable="PORCCONIVAColumn" msprop:Generator_UserColumnName="PORCCONIVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="PORCSINIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPORCSINIVA" msprop:Generator_ColumnPropNameInRow="PORCSINIVA" msprop:Generator_ColumnPropNameInTable="PORCSINIVAColumn" msprop:Generator_UserColumnName="PORCSINIVA" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ComisionVendedorCobrDet" msprop:Generator_TableClassName="ComisionVendedorCobrDetDataTable" msprop:Generator_TableVarName="tableComisionVendedorCobrDet" msprop:Generator_TablePropName="ComisionVendedorCobrDet" msprop:Generator_RowDeletingName="ComisionVendedorCobrDetRowDeleting" msprop:Generator_RowChangingName="ComisionVendedorCobrDetRowChanging" msprop:Generator_RowEvHandlerName="ComisionVendedorCobrDetRowChangeEventHandler" msprop:Generator_RowDeletedName="ComisionVendedorCobrDetRowDeleted" msprop:Generator_UserTableName="ComisionVendedorCobrDet" msprop:Generator_RowChangedName="ComisionVendedorCobrDetRowChanged" msprop:Generator_RowEvArgName="ComisionVendedorCobrDetRowChangeEvent" msprop:Generator_RowClassName="ComisionVendedorCobrDetRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODVENDEDOR" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnCODVENDEDOR" msprop:Generator_ColumnPropNameInRow="CODVENDEDOR" msprop:Generator_ColumnPropNameInTable="CODVENDEDORColumn" msprop:Generator_UserColumnName="CODVENDEDOR" type="xs:int" />
              <xs:element name="NUMVENDEDOR" msprop:Generator_ColumnVarNameInTable="columnNUMVENDEDOR" msprop:Generator_ColumnPropNameInRow="NUMVENDEDOR" msprop:Generator_ColumnPropNameInTable="NUMVENDEDORColumn" msprop:Generator_UserColumnName="NUMVENDEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESVENDEDOR" msprop:Generator_ColumnVarNameInTable="columnDESVENDEDOR" msprop:Generator_ColumnPropNameInRow="DESVENDEDOR" msprop:Generator_ColumnPropNameInTable="DESVENDEDORColumn" msprop:Generator_UserColumnName="DESVENDEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMVENTA" msprop:Generator_ColumnVarNameInTable="columnNUMVENTA" msprop:Generator_ColumnPropNameInRow="NUMVENTA" msprop:Generator_ColumnPropNameInTable="NUMVENTAColumn" msprop:Generator_UserColumnName="NUMVENTA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="20" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHAREGISTROCOB" msprop:Generator_ColumnVarNameInTable="columnFECHAREGISTROCOB" msprop:Generator_ColumnPropNameInRow="FECHAREGISTROCOB" msprop:Generator_ColumnPropNameInTable="FECHAREGISTROCOBColumn" msprop:Generator_UserColumnName="FECHAREGISTROCOB" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NRORECIBO" msprop:Generator_ColumnVarNameInTable="columnNRORECIBO" msprop:Generator_ColumnPropNameInRow="NRORECIBO" msprop:Generator_ColumnPropNameInTable="NRORECIBOColumn" msprop:Generator_UserColumnName="NRORECIBO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="500" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBREFANTASIA" msprop:Generator_ColumnVarNameInTable="columnNOMBREFANTASIA" msprop:Generator_ColumnPropNameInRow="NOMBREFANTASIA" msprop:Generator_ColumnPropNameInTable="NOMBREFANTASIAColumn" msprop:Generator_UserColumnName="NOMBREFANTASIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TOTALCONIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTALCONIVA" msprop:Generator_ColumnPropNameInRow="TOTALCONIVA" msprop:Generator_ColumnPropNameInTable="TOTALCONIVAColumn" msprop:Generator_UserColumnName="TOTALCONIVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTALSINIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTALSINIVA" msprop:Generator_ColumnPropNameInRow="TOTALSINIVA" msprop:Generator_ColumnPropNameInTable="TOTALSINIVAColumn" msprop:Generator_UserColumnName="TOTALSINIVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="NROCOMPROBANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNROCOMPROBANTE" msprop:Generator_ColumnPropNameInRow="NROCOMPROBANTE" msprop:Generator_ColumnPropNameInTable="NROCOMPROBANTEColumn" msprop:Generator_UserColumnName="NROCOMPROBANTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHAFACT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHAFACT" msprop:Generator_ColumnPropNameInRow="FECHAFACT" msprop:Generator_ColumnPropNameInTable="FECHAFACTColumn" msprop:Generator_UserColumnName="FECHAFACT" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHACOMP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHACOMP" msprop:Generator_ColumnPropNameInRow="FECHACOMP" msprop:Generator_ColumnPropNameInTable="FECHACOMPColumn" msprop:Generator_UserColumnName="FECHACOMP" type="xs:dateTime" minOccurs="0" />
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="15" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMCLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMCLIENTE" msprop:Generator_ColumnPropNameInRow="NUMCLIENTE" msprop:Generator_ColumnPropNameInTable="NUMCLIENTEColumn" msprop:Generator_UserColumnName="NUMCLIENTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="NOMBRE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE" msprop:Generator_ColumnPropNameInRow="NOMBRE" msprop:Generator_ColumnPropNameInTable="NOMBREColumn" msprop:Generator_UserColumnName="NOMBRE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DIRECCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIRECCION" msprop:Generator_ColumnPropNameInRow="DIRECCION" msprop:Generator_ColumnPropNameInTable="DIRECCIONColumn" msprop:Generator_UserColumnName="DIRECCION" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESCIUDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCIUDAD" msprop:Generator_ColumnPropNameInRow="DESCIUDAD" msprop:Generator_ColumnPropNameInTable="DESCIUDADColumn" msprop:Generator_UserColumnName="DESCIUDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TELEFONO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTELEFONO" msprop:Generator_ColumnPropNameInRow="TELEFONO" msprop:Generator_ColumnPropNameInTable="TELEFONOColumn" msprop:Generator_UserColumnName="TELEFONO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODCLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODCLIENTE" msprop:Generator_ColumnPropNameInRow="CODCLIENTE" msprop:Generator_ColumnPropNameInTable="CODCLIENTEColumn" msprop:Generator_UserColumnName="CODCLIENTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="NUMDEVOLUCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMDEVOLUCION" msprop:Generator_ColumnPropNameInRow="NUMDEVOLUCION" msprop:Generator_ColumnPropNameInTable="NUMDEVOLUCIONColumn" msprop:Generator_UserColumnName="NUMDEVOLUCION" type="xs:int" minOccurs="0" />
              <xs:element name="CODVENDEDOR1" msdata:ReadOnly="true" msdata:Caption="CODVENDEDOR" msprop:Generator_ColumnVarNameInTable="columnCODVENDEDOR1" msprop:Generator_ColumnPropNameInRow="CODVENDEDOR1" msprop:Generator_ColumnPropNameInTable="CODVENDEDOR1Column" msprop:Generator_UserColumnName="CODVENDEDOR1" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ComisionVendedorCobranzaTipoVenta" msprop:Generator_TableClassName="ComisionVendedorCobranzaTipoVentaDataTable" msprop:Generator_TableVarName="tableComisionVendedorCobranzaTipoVenta" msprop:Generator_TablePropName="ComisionVendedorCobranzaTipoVenta" msprop:Generator_RowDeletingName="ComisionVendedorCobranzaTipoVentaRowDeleting" msprop:Generator_RowChangingName="ComisionVendedorCobranzaTipoVentaRowChanging" msprop:Generator_RowEvHandlerName="ComisionVendedorCobranzaTipoVentaRowChangeEventHandler" msprop:Generator_RowDeletedName="ComisionVendedorCobranzaTipoVentaRowDeleted" msprop:Generator_UserTableName="ComisionVendedorCobranzaTipoVenta" msprop:Generator_RowChangedName="ComisionVendedorCobranzaTipoVentaRowChanged" msprop:Generator_RowEvArgName="ComisionVendedorCobranzaTipoVentaRowChangeEvent" msprop:Generator_RowClassName="ComisionVendedorCobranzaTipoVentaRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="TOTALCONIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTALCONIVA" msprop:Generator_ColumnPropNameInRow="TOTALCONIVA" msprop:Generator_ColumnPropNameInTable="TOTALCONIVAColumn" msprop:Generator_UserColumnName="TOTALCONIVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="TOTALSINIVA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTOTALSINIVA" msprop:Generator_ColumnPropNameInRow="TOTALSINIVA" msprop:Generator_ColumnPropNameInTable="TOTALSINIVAColumn" msprop:Generator_UserColumnName="TOTALSINIVA" type="xs:decimal" minOccurs="0" />
              <xs:element name="NROCOMPROBANTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNROCOMPROBANTE" msprop:Generator_ColumnPropNameInRow="NROCOMPROBANTE" msprop:Generator_ColumnPropNameInTable="NROCOMPROBANTEColumn" msprop:Generator_UserColumnName="NROCOMPROBANTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="502" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMVENTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMVENTA" msprop:Generator_ColumnPropNameInRow="NUMVENTA" msprop:Generator_ColumnPropNameInTable="NUMVENTAColumn" msprop:Generator_UserColumnName="NUMVENTA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="20" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMDEVOLUCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMDEVOLUCION" msprop:Generator_ColumnPropNameInRow="NUMDEVOLUCION" msprop:Generator_ColumnPropNameInTable="NUMDEVOLUCIONColumn" msprop:Generator_UserColumnName="NUMDEVOLUCION" type="xs:int" minOccurs="0" />
              <xs:element name="FECHAFACT" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHAFACT" msprop:Generator_ColumnPropNameInRow="FECHAFACT" msprop:Generator_ColumnPropNameInTable="FECHAFACTColumn" msprop:Generator_UserColumnName="FECHAFACT" type="xs:dateTime" minOccurs="0" />
              <xs:element name="FECHACOMP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHACOMP" msprop:Generator_ColumnPropNameInRow="FECHACOMP" msprop:Generator_ColumnPropNameInTable="FECHACOMPColumn" msprop:Generator_UserColumnName="FECHACOMP" type="xs:dateTime" minOccurs="0" />
              <xs:element name="TIPO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTIPO" msprop:Generator_ColumnPropNameInRow="TIPO" msprop:Generator_ColumnPropNameInTable="TIPOColumn" msprop:Generator_UserColumnName="TIPO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="9" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHAREGISTROCOB" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHAREGISTROCOB" msprop:Generator_ColumnPropNameInRow="FECHAREGISTROCOB" msprop:Generator_ColumnPropNameInTable="FECHAREGISTROCOBColumn" msprop:Generator_UserColumnName="FECHAREGISTROCOB" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NRORECIBO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNRORECIBO" msprop:Generator_ColumnPropNameInRow="NRORECIBO" msprop:Generator_ColumnPropNameInTable="NRORECIBOColumn" msprop:Generator_UserColumnName="NRORECIBO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="502" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMCLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMCLIENTE" msprop:Generator_ColumnPropNameInRow="NUMCLIENTE" msprop:Generator_ColumnPropNameInTable="NUMCLIENTEColumn" msprop:Generator_UserColumnName="NUMCLIENTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="NOMBRE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBRE" msprop:Generator_ColumnPropNameInRow="NOMBRE" msprop:Generator_ColumnPropNameInTable="NOMBREColumn" msprop:Generator_UserColumnName="NOMBRE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DIRECCION" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDIRECCION" msprop:Generator_ColumnPropNameInRow="DIRECCION" msprop:Generator_ColumnPropNameInTable="DIRECCIONColumn" msprop:Generator_UserColumnName="DIRECCION" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESCIUDAD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESCIUDAD" msprop:Generator_ColumnPropNameInRow="DESCIUDAD" msprop:Generator_ColumnPropNameInTable="DESCIUDADColumn" msprop:Generator_UserColumnName="DESCIUDAD" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="TELEFONO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTELEFONO" msprop:Generator_ColumnPropNameInRow="TELEFONO" msprop:Generator_ColumnPropNameInTable="TELEFONOColumn" msprop:Generator_UserColumnName="TELEFONO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODCLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODCLIENTE" msprop:Generator_ColumnPropNameInRow="CODCLIENTE" msprop:Generator_ColumnPropNameInTable="CODCLIENTEColumn" msprop:Generator_UserColumnName="CODCLIENTE" type="xs:int" minOccurs="0" />
              <xs:element name="NOMBREFANTASIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNOMBREFANTASIA" msprop:Generator_ColumnPropNameInRow="NOMBREFANTASIA" msprop:Generator_ColumnPropNameInTable="NOMBREFANTASIAColumn" msprop:Generator_UserColumnName="NOMBREFANTASIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MODALIDADPAGO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMODALIDADPAGO" msprop:Generator_ColumnPropNameInRow="MODALIDADPAGO" msprop:Generator_ColumnPropNameInTable="MODALIDADPAGOColumn" msprop:Generator_UserColumnName="MODALIDADPAGO" type="xs:unsignedByte" minOccurs="0" />
              <xs:element name="CODVENDEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODVENDEDOR" msprop:Generator_ColumnPropNameInRow="CODVENDEDOR" msprop:Generator_ColumnPropNameInTable="CODVENDEDORColumn" msprop:Generator_UserColumnName="CODVENDEDOR" type="xs:int" minOccurs="0" />
              <xs:element name="NUMVENDEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnNUMVENDEDOR" msprop:Generator_ColumnPropNameInRow="NUMVENDEDOR" msprop:Generator_ColumnPropNameInTable="NUMVENDEDORColumn" msprop:Generator_UserColumnName="NUMVENDEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESVENDEDOR" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESVENDEDOR" msprop:Generator_ColumnPropNameInRow="DESVENDEDOR" msprop:Generator_ColumnPropNameInTable="DESVENDEDORColumn" msprop:Generator_UserColumnName="DESVENDEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="ComisionNotasCredito" msprop:Generator_TableClassName="ComisionNotasCreditoDataTable" msprop:Generator_TableVarName="tableComisionNotasCredito" msprop:Generator_RowChangedName="ComisionNotasCreditoRowChanged" msprop:Generator_TablePropName="ComisionNotasCredito" msprop:Generator_RowDeletingName="ComisionNotasCreditoRowDeleting" msprop:Generator_RowChangingName="ComisionNotasCreditoRowChanging" msprop:Generator_RowEvHandlerName="ComisionNotasCreditoRowChangeEventHandler" msprop:Generator_RowDeletedName="ComisionNotasCreditoRowDeleted" msprop:Generator_RowClassName="ComisionNotasCreditoRow" msprop:Generator_UserTableName="ComisionNotasCredito" msprop:Generator_RowEvArgName="ComisionNotasCreditoRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="NUMDEVOLUCION" msprop:Generator_ColumnVarNameInTable="columnNUMDEVOLUCION" msprop:Generator_ColumnPropNameInRow="NUMDEVOLUCION" msprop:Generator_ColumnPropNameInTable="NUMDEVOLUCIONColumn" msprop:Generator_UserColumnName="NUMDEVOLUCION" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="20" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE" msprop:Generator_ColumnVarNameInTable="columnNOMBRE" msprop:Generator_ColumnPropNameInRow="NOMBRE" msprop:Generator_ColumnPropNameInTable="NOMBREColumn" msprop:Generator_UserColumnName="NOMBRE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODVENDEDOR" msprop:Generator_ColumnVarNameInTable="columnCODVENDEDOR" msprop:Generator_ColumnPropNameInRow="CODVENDEDOR" msprop:Generator_ColumnPropNameInTable="CODVENDEDORColumn" msprop:Generator_UserColumnName="CODVENDEDOR" type="xs:decimal" />
              <xs:element name="CODTIPOCOBRO" msprop:Generator_ColumnVarNameInTable="columnCODTIPOCOBRO" msprop:Generator_ColumnPropNameInRow="CODTIPOCOBRO" msprop:Generator_ColumnPropNameInTable="CODTIPOCOBROColumn" msprop:Generator_UserColumnName="CODTIPOCOBRO" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESTIPOCOBRO" msprop:Generator_ColumnVarNameInTable="columnDESTIPOCOBRO" msprop:Generator_ColumnPropNameInRow="DESTIPOCOBRO" msprop:Generator_ColumnPropNameInTable="DESTIPOCOBROColumn" msprop:Generator_UserColumnName="DESTIPOCOBRO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="FECHACOBRO" msprop:Generator_ColumnVarNameInTable="columnFECHACOBRO" msprop:Generator_ColumnPropNameInRow="FECHACOBRO" msprop:Generator_ColumnPropNameInTable="FECHACOBROColumn" msprop:Generator_UserColumnName="FECHACOBRO" type="xs:dateTime" minOccurs="0" />
              <xs:element name="NRORECIBO" msprop:Generator_ColumnVarNameInTable="columnNRORECIBO" msprop:Generator_ColumnPropNameInRow="NRORECIBO" msprop:Generator_ColumnPropNameInTable="NRORECIBOColumn" msprop:Generator_UserColumnName="NRORECIBO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="500" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBREFANTASIA" msprop:Generator_ColumnVarNameInTable="columnNOMBREFANTASIA" msprop:Generator_ColumnPropNameInRow="NOMBREFANTASIA" msprop:Generator_ColumnPropNameInTable="NOMBREFANTASIAColumn" msprop:Generator_UserColumnName="NOMBREFANTASIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMVENTA" msprop:Generator_ColumnVarNameInTable="columnNUMVENTA" msprop:Generator_ColumnPropNameInRow="NUMVENTA" msprop:Generator_ColumnPropNameInTable="NUMVENTAColumn" msprop:Generator_UserColumnName="NUMVENTA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="20" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESVENDEDOR" msprop:Generator_ColumnVarNameInTable="columnDESVENDEDOR" msprop:Generator_ColumnPropNameInRow="DESVENDEDOR" msprop:Generator_ColumnPropNameInTable="DESVENDEDORColumn" msprop:Generator_UserColumnName="DESVENDEDOR" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="importesiniva" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnimportesiniva" msprop:Generator_ColumnPropNameInRow="importesiniva" msprop:Generator_ColumnPropNameInTable="importesinivaColumn" msprop:Generator_UserColumnName="importesiniva" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
    <xs:unique name="Constraint1" msdata:PrimaryKey="true">
      <xs:selector xpath=".//mstns:ComisionVendedorCobranza" />
      <xs:field xpath="mstns:CODVENDEDOR" />
    </xs:unique>
    <xs:unique name="ComisionVendedorFacturacion_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
      <xs:selector xpath=".//mstns:ComisionVendedorFacturacion" />
      <xs:field xpath="mstns:CODVENDEDOR" />
    </xs:unique>
    <xs:unique name="ComisionVendedorCobrDet_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
      <xs:selector xpath=".//mstns:ComisionVendedorCobrDet" />
      <xs:field xpath="mstns:CODVENDEDOR" />
    </xs:unique>
    <xs:unique name="ComisionNotasCredito_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
      <xs:selector xpath=".//mstns:ComisionNotasCredito" />
      <xs:field xpath="mstns:CODVENDEDOR" />
    </xs:unique>
  </xs:element>
</xs:schema>