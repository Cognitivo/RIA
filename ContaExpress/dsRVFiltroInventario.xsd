<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="dsRVFiltroInventario" targetNamespace="http://tempuri.org/dsRVFiltroInventario.xsd" xmlns:mstns="http://tempuri.org/dsRVFiltroInventario.xsd" xmlns="http://tempuri.org/dsRVFiltroInventario.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="MySettings" AppSettingsPropertyName="GESTIONConnectionString2" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="GESTIONConnectionString2 (MySettings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.ContaExpress.My.MySettings.GlobalReference.Default.GESTIONConnectionString2" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RVFISTOCKAUNAFECHATableAdapter" GeneratorDataComponentClassName="RVFISTOCKAUNAFECHATableAdapter" Name="RVFISTOCKAUNAFECHA" UserDataComponentName="RVFISTOCKAUNAFECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT COD.CODCODIGO, COD.CODIGO, PRODUCTOS.DESPRODUCTO, FAMILIA.DESFAMILIA, UNIDADMEDIDA.DESMEDIDA,
                             (SELECT        STOCK
                               FROM            STOCKHISTORICO
                               WHERE        (CODCODIGO = COD.CODCODIGO) AND (CODDEPOSITO = SD.CODDEPOSITO)) 
                         + ISNULL
                             ((SELECT        SUM(CANTIDAD) AS Expr1
                                 FROM            MOVPRODUCTO
                                 WHERE        (CODCODIGO = COD.CODCODIGO) AND  
                                                          (CODDEPOSITO = SD.CODDEPOSITO)), 0) AS STOCKFECHA, SUCURSAL.DESSUCURSAL, SUCURSAL.CODSUCURSAL, COD.PRECIO
FROM            CODIGOS AS COD INNER JOIN
                         PRODUCTOS ON COD.CODPRODUCTO = PRODUCTOS.CODPRODUCTO INNER JOIN
                         STOCKDEPOSITO AS SD ON COD.CODCODIGO = SD.CODCODIGO INNER JOIN
                         SUCURSAL ON SD.CODDEPOSITO = SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                         UNIDADMEDIDA ON PRODUCTOS.CODMEDIDA = UNIDADMEDIDA.CODMEDIDA LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA
ORDER BY PRODUCTOS.DESPRODUCTO</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODCODIGO" DataSetColumn="CODCODIGO" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="DESPRODUCTO" DataSetColumn="DESPRODUCTO" />
              <Mapping SourceColumn="DESFAMILIA" DataSetColumn="DESFAMILIA" />
              <Mapping SourceColumn="DESMEDIDA" DataSetColumn="DESMEDIDA" />
              <Mapping SourceColumn="STOCKFECHA" DataSetColumn="STOCKFECHA" />
              <Mapping SourceColumn="DESSUCURSAL" DataSetColumn="DESSUCURSAL" />
              <Mapping SourceColumn="CODSUCURSAL" DataSetColumn="CODSUCURSAL" />
              <Mapping SourceColumn="PRECIO" DataSetColumn="PRECIO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy1Prod" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy1Prod" GeneratorSourceName="FillBy1Prod" GetMethodModifier="Public" GetMethodName="GetDataBy1Prod" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy1Prod" UserSourceName="FillBy1Prod">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT COD.CODCODIGO, COD.CODIGO, PRODUCTOS.DESPRODUCTO, FAMILIA.DESFAMILIA, UNIDADMEDIDA.DESMEDIDA,
                             (SELECT        STOCK
                               FROM            STOCKHISTORICO
                               WHERE        (MONTH(FECHA) = @MESANT) AND (YEAR(FECHA) = @AÑO) AND (CODCODIGO = COD.CODCODIGO) AND (CODDEPOSITO = SD.CODDEPOSITO)) 
                         + ISNULL
                             ((SELECT        SUM(CANTIDAD) AS Expr1
                                 FROM            MOVPRODUCTO
                                 WHERE        (CODCODIGO = COD.CODCODIGO) AND (FECHAMOVIMIENTO &gt;= @FECHAMOVINI) AND (FECHAMOVIMIENTO &lt;= @FECHAMOVHASTA) AND 
                                                          (CODDEPOSITO = SD.CODDEPOSITO)), 0) AS STOCKFECHA, SUCURSAL.DESSUCURSAL, SUCURSAL.CODSUCURSAL, COD.PRECIO
FROM            CODIGOS AS COD INNER JOIN
                         PRODUCTOS ON COD.CODPRODUCTO = PRODUCTOS.CODPRODUCTO INNER JOIN
                         STOCKDEPOSITO AS SD ON COD.CODCODIGO = SD.CODCODIGO INNER JOIN
                         SUCURSAL ON SD.CODDEPOSITO = SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                         UNIDADMEDIDA ON PRODUCTOS.CODMEDIDA = UNIDADMEDIDA.CODMEDIDA LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA
WHERE        (COD.CODCODIGO = @CODCODIGO) 
AND (SUCURSAL.CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1))
ORDER BY PRODUCTOS.DESPRODUCTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="CODCODIGO" ColumnName="CODCODIGO" DataSourceName="FIPAR.dbo.CODIGOS" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CODCODIGO" Precision="0" ProviderType="Int" Scale="0" Size="4" SourceColumn="CODCODIGO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MESANT" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MESANT" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="AÑO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@AÑO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVINI" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVINI" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVHASTA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVHASTA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByFamilia" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByFamilia" GeneratorSourceName="FillByFamilia" GetMethodModifier="Public" GetMethodName="GetDataByFamilia" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByFamilia" UserSourceName="FillByFamilia">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT COD.CODCODIGO, COD.CODIGO, PRODUCTOS.DESPRODUCTO, FAMILIA.DESFAMILIA, UNIDADMEDIDA.DESMEDIDA,
                             (SELECT        STOCK
                               FROM            STOCKHISTORICO
                               WHERE        (MONTH(FECHA) = @MESANT) AND (YEAR(FECHA) = @AÑO) AND (CODCODIGO = COD.CODCODIGO) AND (CODDEPOSITO = SD.CODDEPOSITO)) 
                         + ISNULL
                             ((SELECT        SUM(CANTIDAD) AS Expr1
                                 FROM            MOVPRODUCTO
                                 WHERE        (CODCODIGO = COD.CODCODIGO) AND (FECHAMOVIMIENTO &gt;= @FECHAMOVINI) AND (FECHAMOVIMIENTO &lt;= @FECHAMOVHASTA) AND 
                                                          (CODDEPOSITO = SD.CODDEPOSITO)), 0) AS STOCKFECHA, SUCURSAL.DESSUCURSAL, SUCURSAL.CODSUCURSAL, COD.PRECIO
FROM            CODIGOS AS COD INNER JOIN
                         PRODUCTOS ON COD.CODPRODUCTO = PRODUCTOS.CODPRODUCTO INNER JOIN
                         STOCKDEPOSITO AS SD ON COD.CODCODIGO = SD.CODCODIGO INNER JOIN
                         SUCURSAL ON SD.CODDEPOSITO = SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                         UNIDADMEDIDA ON PRODUCTOS.CODMEDIDA = UNIDADMEDIDA.CODMEDIDA LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA
WHERE        (FAMILIA.DESFAMILIA LIKE @DESFAMILIA) AND (SD.CODDEPOSITO IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1))
ORDER BY PRODUCTOS.DESPRODUCTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="DESFAMILIA" ColumnName="DESFAMILIA" DataSourceName="Guazu0710.dbo.FAMILIA" DataTypeServer="varchar(50)" DbType="AnsiString" Direction="Input" ParameterName="@DESFAMILIA" Precision="0" ProviderType="VarChar" Scale="0" Size="50" SourceColumn="DESFAMILIA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MESANT" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MESANT" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="AÑO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@AÑO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVINI" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVINI" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVHASTA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVHASTA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByListaProd" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByListaProd" GeneratorSourceName="FillByListaProd" GetMethodModifier="Public" GetMethodName="GetDataByListaProd" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByListaProd" UserSourceName="FillByListaProd">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT COD.CODCODIGO, COD.CODIGO, PRODUCTOS.DESPRODUCTO, FAMILIA.DESFAMILIA, UNIDADMEDIDA.DESMEDIDA,
                             (SELECT        STOCK
                               FROM            STOCKHISTORICO
                               WHERE        (MONTH(FECHA) = @MESANT) AND (YEAR(FECHA) = @AÑO) AND (CODCODIGO = COD.CODCODIGO) AND (CODDEPOSITO = SD.CODDEPOSITO)) 
                         + ISNULL
                             ((SELECT        SUM(CANTIDAD) AS Expr1
                                 FROM            MOVPRODUCTO
                                 WHERE        (CODCODIGO = COD.CODCODIGO) AND (FECHAMOVIMIENTO &gt;= @FECHAMOVINI) AND (FECHAMOVIMIENTO &lt;= @FECHAMOVHASTA) AND 
                                                          (CODDEPOSITO = SD.CODDEPOSITO)), 0) AS STOCKFECHA, SUCURSAL.DESSUCURSAL, SUCURSAL.CODSUCURSAL, COD.PRECIO
FROM            CODIGOS AS COD INNER JOIN
                         PRODUCTOS ON COD.CODPRODUCTO = PRODUCTOS.CODPRODUCTO INNER JOIN
                         STOCKDEPOSITO AS SD ON COD.CODCODIGO = SD.CODCODIGO INNER JOIN
                         SUCURSAL ON SD.CODDEPOSITO = SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                         UNIDADMEDIDA ON PRODUCTOS.CODMEDIDA = UNIDADMEDIDA.CODMEDIDA LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA
WHERE        (COD.CODIGO IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@LISTAPROD, ',') AS fnPartir_1)) AND (SD.CODDEPOSITO IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1))
ORDER BY PRODUCTOS.DESPRODUCTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="MESANT" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MESANT" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="AÑO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@AÑO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVINI" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVINI" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVHASTA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVHASTA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="LISTAPROD" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@LISTAPROD" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByProdDH" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByProdDH" GeneratorSourceName="FillByProdDH" GetMethodModifier="Public" GetMethodName="GetDataByProdDH" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByProdDH" UserSourceName="FillByProdDH">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT COD.CODCODIGO, COD.CODIGO, PRODUCTOS.DESPRODUCTO, FAMILIA.DESFAMILIA, UNIDADMEDIDA.DESMEDIDA,
                             (SELECT        STOCK
                               FROM            STOCKHISTORICO
                               WHERE        (MONTH(FECHA) = @MESANT) AND (YEAR(FECHA) = @AÑO) AND (CODCODIGO = COD.CODCODIGO) AND (CODDEPOSITO = SD.CODDEPOSITO)) 
                         + ISNULL
                             ((SELECT        SUM(CANTIDAD) AS Expr1
                                 FROM            MOVPRODUCTO
                                 WHERE        (CODCODIGO = COD.CODCODIGO) AND (FECHAMOVIMIENTO &gt;= @FECHAMOVINI) AND (FECHAMOVIMIENTO &lt;= @FECHAMOVHASTA) AND 
                                                          (CODDEPOSITO = SD.CODDEPOSITO)), 0) AS STOCKFECHA, SUCURSAL.DESSUCURSAL, SUCURSAL.CODSUCURSAL, COD.PRECIO
FROM            CODIGOS AS COD INNER JOIN
                         PRODUCTOS ON COD.CODPRODUCTO = PRODUCTOS.CODPRODUCTO INNER JOIN
                         STOCKDEPOSITO AS SD ON COD.CODCODIGO = SD.CODCODIGO INNER JOIN
                         SUCURSAL ON SD.CODDEPOSITO = SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                         UNIDADMEDIDA ON PRODUCTOS.CODMEDIDA = UNIDADMEDIDA.CODMEDIDA LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA
WHERE        (COD.CODIGO BETWEEN @codini AND @codfin) AND (SD.CODDEPOSITO IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1))
ORDER BY PRODUCTOS.DESPRODUCTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="codini" ColumnName="CODIGO" DataSourceName="Guazu0710.dbo.CODIGOS" DataTypeServer="varchar(150)" DbType="AnsiString" Direction="Input" ParameterName="@codini" Precision="0" ProviderType="VarChar" Scale="0" Size="150" SourceColumn="CODIGO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="codfin" ColumnName="CODIGO" DataSourceName="Guazu0710.dbo.CODIGOS" DataTypeServer="varchar(150)" DbType="AnsiString" Direction="Input" ParameterName="@codfin" Precision="0" ProviderType="VarChar" Scale="0" Size="150" SourceColumn="CODIGO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MESANT" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MESANT" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="AÑO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@AÑO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVINI" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVINI" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVHASTA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVHASTA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByTP" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByTP" GeneratorSourceName="FillByTP" GetMethodModifier="Public" GetMethodName="GetDataByTP" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByTP" UserSourceName="FillByTP">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT COD.CODCODIGO, COD.CODIGO, PRODUCTOS.DESPRODUCTO, FAMILIA.DESFAMILIA, UNIDADMEDIDA.DESMEDIDA,
                             (SELECT        STOCK
                               FROM            STOCKHISTORICO
                               WHERE        (MONTH(FECHA) = @MESANT) AND (YEAR(FECHA) = @AÑO) AND (CODCODIGO = COD.CODCODIGO) AND (CODDEPOSITO = SD.CODDEPOSITO)) 
                         + ISNULL
                             ((SELECT        SUM(CANTIDAD) AS Expr1
                                 FROM            MOVPRODUCTO
                                 WHERE        (CODCODIGO = COD.CODCODIGO) AND (FECHAMOVIMIENTO &gt;= @FECHAMOVINI) AND (FECHAMOVIMIENTO &lt;= @FECHAMOVHASTA) AND 
                                                          (CODDEPOSITO = SD.CODDEPOSITO)), 0) AS STOCKFECHA, SUCURSAL.DESSUCURSAL, SUCURSAL.CODSUCURSAL, COD.PRECIO
FROM            CODIGOS AS COD INNER JOIN
                         PRODUCTOS ON COD.CODPRODUCTO = PRODUCTOS.CODPRODUCTO INNER JOIN
                         STOCKDEPOSITO AS SD ON COD.CODCODIGO = SD.CODCODIGO INNER JOIN
                         SUCURSAL ON SD.CODDEPOSITO = SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                         UNIDADMEDIDA ON PRODUCTOS.CODMEDIDA = UNIDADMEDIDA.CODMEDIDA LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA
WHERE        (SD.CODDEPOSITO IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1))
ORDER BY PRODUCTOS.DESPRODUCTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="MESANT" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MESANT" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="AÑO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@AÑO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVINI" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVINI" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="FECHAMOVHASTA" ColumnName="" DataSourceName="" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@FECHAMOVHASTA" Precision="0" Scale="0" Size="8" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RIMOVPRODUCTOXRANGOFECHATableAdapter" GeneratorDataComponentClassName="RIMOVPRODUCTOXRANGOFECHATableAdapter" Name="RIMOVPRODUCTOXRANGOFECHA" UserDataComponentName="RIMOVPRODUCTOXRANGOFECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill1PSuc" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData1PSuc" GeneratorSourceName="Fill1PSuc" GetMethodModifier="Public" GetMethodName="GetData1PSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData1PSuc" UserSourceName="Fill1PSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CODSUCURSAL IN (SELECT        item FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND 
                                                    (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD)
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODCOD" ColumnName="CODCODIGO" DataSourceName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CODCOD" Precision="0" Scale="0" Size="4" SourceColumn="CODCODIGO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="PRODUCTO" DataSetColumn="PRODUCTO" />
              <Mapping SourceColumn="STOCKINICIAL" DataSetColumn="STOCKINICIAL" />
              <Mapping SourceColumn="COMPRA" DataSetColumn="COMPRA" />
              <Mapping SourceColumn="DEVOLUCIONCLIENTE" DataSetColumn="DEVOLUCIONCLIENTE" />
              <Mapping SourceColumn="TRANSFERENCIAENTRADA" DataSetColumn="TRANSFERENCIAENTRADA" />
              <Mapping SourceColumn="AJUSTEENTRADA" DataSetColumn="AJUSTEENTRADA" />
              <Mapping SourceColumn="ANULDEVCOMP" DataSetColumn="ANULDEVCOMP" />
              <Mapping SourceColumn="VENTA" DataSetColumn="VENTA" />
              <Mapping SourceColumn="ENTRPROD" DataSetColumn="ENTRPROD" />
              <Mapping SourceColumn="ANULVTA" DataSetColumn="ANULVTA" />
              <Mapping SourceColumn="SALPROD" DataSetColumn="SALPROD" />
              <Mapping SourceColumn="DEVCOMP" DataSetColumn="DEVCOMP" />
              <Mapping SourceColumn="ANULCOMP" DataSetColumn="ANULCOMP" />
              <Mapping SourceColumn="TRANSFERENCIASALIDA" DataSetColumn="TRANSFERENCIASALIDA" />
              <Mapping SourceColumn="AJUSTESALIDA" DataSetColumn="AJUSTESALIDA" />
              <Mapping SourceColumn="ANULDEVVTA" DataSetColumn="ANULDEVVTA" />
              <Mapping SourceColumn="CODSUCURSAL" DataSetColumn="CODSUCURSAL" />
              <Mapping SourceColumn="DESFAMILIA" DataSetColumn="DESFAMILIA" />
              <Mapping SourceColumn="DESLINEA" DataSetColumn="DESLINEA" />
              <Mapping SourceColumn="CODCODIGO" DataSetColumn="CODCODIGO" />
              <Mapping SourceColumn="CODRUBRO" DataSetColumn="CODRUBRO" />
              <Mapping SourceColumn="DESSUCURSAL" DataSetColumn="DESSUCURSAL" />
              <Mapping SourceColumn="DESRUBRO" DataSetColumn="DESRUBRO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy1PSinSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy1PSinSuc" GeneratorSourceName="FillBy1PSinSuc" GetMethodModifier="Public" GetMethodName="GetDataBy1PSinSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy1PSinSuc" UserSourceName="FillBy1PSinSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>
SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                                                    CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD)
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODCOD" ColumnName="CODCODIGO" DataSourceName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CODCOD" Precision="0" Scale="0" Size="4" SourceColumn="CODCODIGO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) AND DESFAMILIA LIKE @DESFAMILIA GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByFPS" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByFPS" GeneratorSourceName="FillByFPS" GetMethodModifier="Public" GetMethodName="GetDataByFPS" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByFPS" UserSourceName="FillByFPS">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CODSUCURSAL IN (SELECT        item FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND 
                                                    (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) And DESFAMILIA like @DESFAMILIA
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODCOD" ColumnName="CODCODIGO" DataSourceName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) AND DESFAMILIA LIKE @DESFAMILIA GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CODCOD" Precision="0" Scale="0" Size="4" SourceColumn="CODCODIGO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="DESFAMILIA" ColumnName="DESFAMILIA" DataSourceName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) AND DESFAMILIA LIKE @DESFAMILIA GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DataTypeServer="varchar(50)" DbType="AnsiString" Direction="Input" ParameterName="@DESFAMILIA" Precision="0" Scale="0" Size="50" SourceColumn="DESFAMILIA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) AND DESFAMILIA LIKE @DESFAMILIA GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByFPSinS" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByFPSinS" GeneratorSourceName="FillByFPSinS" GetMethodModifier="Public" GetMethodName="GetDataByFPSinS" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByFPSinS" UserSourceName="FillByFPSinS">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>
SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                                                    CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) And DESFAMILIA like @DESFAMILIA
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODCOD" ColumnName="CODCODIGO" DataSourceName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) AND DESFAMILIA LIKE @DESFAMILIA GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CODCOD" Precision="0" Scale="0" Size="4" SourceColumn="CODCODIGO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="DESFAMILIA" ColumnName="DESFAMILIA" DataSourceName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD) AND DESFAMILIA LIKE @DESFAMILIA GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DataTypeServer="varchar(50)" DbType="AnsiString" Direction="Input" ParameterName="@DESFAMILIA" Precision="0" Scale="0" Size="50" SourceColumn="DESFAMILIA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (DESFAMILIA LIKE @DesFamilia) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByFSinPyS" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByFSinPyS" GeneratorSourceName="FillByFSinPyS" GetMethodModifier="Public" GetMethodName="GetDataByFSinPyS" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByFSinPyS" UserSourceName="FillByFSinPyS">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>
SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                                                    CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (DESFAMILIA like @DesFamilia)
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="DesFamilia" ColumnName="DESFAMILIA" DataSourceName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (DESFAMILIA LIKE @DesFamilia) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DataTypeServer="varchar(50)" DbType="AnsiString" Direction="Input" ParameterName="@DesFamilia" Precision="0" Scale="0" Size="50" SourceColumn="DESFAMILIA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (DESFAMILIA LIKE @DESFAMILIA) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByFSsinP" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByFSsinP" GeneratorSourceName="FillByFSsinP" GetMethodModifier="Public" GetMethodName="GetDataByFSsinP" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByFSsinP" UserSourceName="FillByFSsinP">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CODSUCURSAL IN (SELECT        item FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND 
                                                    (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (DESFAMILIA like @DESFAMILIA)
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="DESFAMILIA" ColumnName="DESFAMILIA" DataSourceName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (DESFAMILIA LIKE @DESFAMILIA) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DataTypeServer="varchar(50)" DbType="AnsiString" Direction="Input" ParameterName="@DESFAMILIA" Precision="0" Scale="0" Size="50" SourceColumn="DESFAMILIA" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODIGO IN (SELECT item FROM dbo.fnPartir( @Plan , ',') AS fnPartir_1)) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByLPSinSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByLPSinSuc" GeneratorSourceName="FillByLPSinSuc" GetMethodModifier="Public" GetMethodName="GetDataByLPSinSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByLPSinSuc" UserSourceName="FillByLPSinSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                                                    CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODIGO IN
                                                        (SELECT        item
                                                          FROM            dbo.fnPartir(@Plan, ',') AS fnPartir_1))
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="Plan" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@Plan" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODIGO IN (SELECT item FROM dbo.fnPartir( @Plan , ',') AS fnPartir_1)) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByLPSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByLPSuc" GeneratorSourceName="FillByLPSuc" GetMethodModifier="Public" GetMethodName="GetDataByLPSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByLPSuc" UserSourceName="FillByLPSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CODSUCURSAL IN (SELECT        item FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND 
                                                    (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODIGO IN
                                                        (SELECT        item
                                                          FROM            dbo.fnPartir(@Plan, ',') AS fnPartir_1))
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="Plan" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@Plan" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByTPSinSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByTPSinSuc" GeneratorSourceName="FillByTPSinSuc" GetMethodModifier="Public" GetMethodName="GetDataByTPSinSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByTPSinSuc" UserSourceName="FillByTPSinSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                                                    CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103))
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO FROM (SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta WHERE (CODSUCURSAL IN (SELECT item FROM dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, CODRUBRO, DESRUBRO ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByTPSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByTPSuc" GeneratorSourceName="FillByTPSuc" GetMethodModifier="Public" GetMethodName="GetDataByTPSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByTPSuc" UserSourceName="FillByTPSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                                                    AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, 
                                                    SUM(ANULDEVCOMP) AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) 
                                                    AS SALPROD, SUM(DEVCOMP) AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, 
                                                    SUM(AJUSTESALIDA) AS AJUSTESALIDA, SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, 
                                                    CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
                          FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) 
                                                                              + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, 
                                                                              dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                                              M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                                              CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND 
                                                                              M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                                              M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND 
                                                                              UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR
                                                                              M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                                              M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                                              THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                                                    FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                                              dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                                              dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                                              dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                                              dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                                              dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                                              dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
                          WHERE        (CODSUCURSAL IN (SELECT        item FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND 
                                                    (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103))
                          GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), 
                                                    DESSUCURSAL, CODRUBRO, DESRUBRO
                          ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO) AS Subconsulta2
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, DESSUCURSAL, CODRUBRO, DESRUBRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RIMOVPRODUCTOPORFECHATableAdapter" GeneratorDataComponentClassName="RIMOVPRODUCTOPORFECHATableAdapter" Name="RIMOVPRODUCTOPORFECHA" UserDataComponentName="RIMOVPRODUCTOPORFECHATableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBySuc" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetDataBySuc" GeneratorSourceName="FillBySuc" GetMethodModifier="Public" GetMethodName="GetDataBySuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBySuc" UserSourceName="FillBySuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)),
                          103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, 
                                                    '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, 
                                                    CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) 
                                                    = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                    M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                    M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA,
                                                     CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND 
                                                    (M.MODULO = 13 OR
                                                    M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                    M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                          FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                    dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                    dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                    dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                    dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                    dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                    dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
WHERE        (CODSUCURSAL IN (SELECT        item FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1)) AND (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND 
                         (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD)
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, 
                         CODRUBRO, DESRUBRO
ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODCOD" ColumnName="CODCODIGO" DataSourceName="SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CODCOD" Precision="0" Scale="0" Size="4" SourceColumn="CODCODIGO" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="PRODUCTO" DataSetColumn="PRODUCTO" />
              <Mapping SourceColumn="STOCKINICIAL" DataSetColumn="STOCKINICIAL" />
              <Mapping SourceColumn="COMPRA" DataSetColumn="COMPRA" />
              <Mapping SourceColumn="DEVOLUCIONCLIENTE" DataSetColumn="DEVOLUCIONCLIENTE" />
              <Mapping SourceColumn="TRANSFERENCIAENTRADA" DataSetColumn="TRANSFERENCIAENTRADA" />
              <Mapping SourceColumn="AJUSTEENTRADA" DataSetColumn="AJUSTEENTRADA" />
              <Mapping SourceColumn="ANULDEVCOMP" DataSetColumn="ANULDEVCOMP" />
              <Mapping SourceColumn="VENTA" DataSetColumn="VENTA" />
              <Mapping SourceColumn="ENTRPROD" DataSetColumn="ENTRPROD" />
              <Mapping SourceColumn="ANULVTA" DataSetColumn="ANULVTA" />
              <Mapping SourceColumn="SALPROD" DataSetColumn="SALPROD" />
              <Mapping SourceColumn="DEVCOMP" DataSetColumn="DEVCOMP" />
              <Mapping SourceColumn="ANULCOMP" DataSetColumn="ANULCOMP" />
              <Mapping SourceColumn="TRANSFERENCIASALIDA" DataSetColumn="TRANSFERENCIASALIDA" />
              <Mapping SourceColumn="AJUSTESALIDA" DataSetColumn="AJUSTESALIDA" />
              <Mapping SourceColumn="ANULDEVVTA" DataSetColumn="ANULDEVVTA" />
              <Mapping SourceColumn="CODSUCURSAL" DataSetColumn="CODSUCURSAL" />
              <Mapping SourceColumn="DESFAMILIA" DataSetColumn="DESFAMILIA" />
              <Mapping SourceColumn="DESLINEA" DataSetColumn="DESLINEA" />
              <Mapping SourceColumn="CODCODIGO" DataSetColumn="CODCODIGO" />
              <Mapping SourceColumn="CODRUBRO" DataSetColumn="CODRUBRO" />
              <Mapping SourceColumn="FECHAMTO" DataSetColumn="FECHAMTO" />
              <Mapping SourceColumn="DESSUCURSAL" DataSetColumn="DESSUCURSAL" />
              <Mapping SourceColumn="DESRUBRO" DataSetColumn="DESRUBRO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByLPSinSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByLPSinSuc" GeneratorSourceName="FillByLPSinSuc" GetMethodModifier="Public" GetMethodName="GetDataByLPSinSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByLPSinSuc" UserSourceName="FillByLPSinSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)),
                          103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, 
                                                    '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, 
                                                    CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) 
                                                    = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                    M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                    M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA,
                                                     CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND 
                                                    (M.MODULO = 13 OR
                                                    M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                    M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                          FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                    dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                    dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                    dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                    dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                    dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                    dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                         CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODIGO IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@Plan, ',') AS fnPartir_1))
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, 
                         CODRUBRO, DESRUBRO
ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="Plan" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@Plan" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByLPSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByLPSuc" GeneratorSourceName="FillByLPSuc" GetMethodModifier="Public" GetMethodName="GetDataByLPSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByLPSuc" UserSourceName="FillByLPSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)),
                          103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, 
                                                    '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, 
                                                    CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) 
                                                    = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                    M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                    M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA,
                                                     CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND 
                                                    (M.MODULO = 13 OR
                                                    M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                    M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                          FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                    dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                    dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                    dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                    dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                    dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                    dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                         CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODIGO IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@Plan, ',') AS fnPartir_1)) AND (CODSUCURSAL IN (SELECT        item FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1))
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, 
                         CODRUBRO, DESRUBRO
ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="Plan" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@Plan" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBySinSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBySinSuc" GeneratorSourceName="FillBySinSuc" GetMethodModifier="Public" GetMethodName="GetDataBySinSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBySinSuc" UserSourceName="FillBySinSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)),
                          103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, 
                                                    '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, 
                                                    CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) 
                                                    = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                    M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                    M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA,
                                                     CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND 
                                                    (M.MODULO = 13 OR
                                                    M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                    M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                          FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                    dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                    dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                    dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                    dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                    dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                    dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                         CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODCODIGO = @CODCOD)
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, 
                         CODRUBRO, DESRUBRO
ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODCOD" ColumnName="CODCODIGO" DataSourceName="SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@CODCOD" Precision="0" Scale="0" Size="4" SourceColumn="CODCODIGO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByTPSinSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByTPSinSuc" GeneratorSourceName="FillByTPSinSuc" GetMethodModifier="Public" GetMethodName="GetDataByTPSinSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByTPSinSuc" UserSourceName="FillByTPSinSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)),
                          103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, 
                                                    '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, 
                                                    CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) 
                                                    = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                    M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                    M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA,
                                                     CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND 
                                                    (M.MODULO = 13 OR
                                                    M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                    M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                          FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                    dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                    dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                    dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                    dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                    dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                    dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                         CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103))
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, 
                         CODRUBRO, DESRUBRO
ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND (M.MODULO = 13 OR M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO FROM dbo.MOVPRODUCTO AS M INNER JOIN dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByTPSuc" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByTPSuc" GeneratorSourceName="FillByTPSuc" GetMethodModifier="Public" GetMethodName="GetDataByTPSuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByTPSuc" UserSourceName="FillByTPSuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>
SELECT        TOP (100) PERCENT CODIGO, PRODUCTO, SUM(STOCKINICIAL) AS STOCKINICIAL, SUM(COMPRA) AS COMPRA, SUM(DEVOLUCIONCLIENTE) 
                         AS DEVOLUCIONCLIENTE, SUM(TRANSFERENCIAENTRADA) AS TRANSFERENCIAENTRADA, SUM(AJUSTEENTRADA) AS AJUSTEENTRADA, SUM(ANULDEVCOMP) 
                         AS ANULDEVCOMP, SUM(VENTA) AS VENTA, SUM(ENTRPROD) AS ENTRPROD, SUM(ANULVTA) AS ANULVTA, SUM(SALPROD) AS SALPROD, SUM(DEVCOMP) 
                         AS DEVCOMP, SUM(ANULCOMP) AS ANULCOMP, SUM(TRANSFERENCIASALIDA) AS TRANSFERENCIASALIDA, SUM(AJUSTESALIDA) AS AJUSTESALIDA, 
                         SUM(ANULDEVVTA) AS ANULDEVVTA, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CODRUBRO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)),
                          103) AS FECHAMTO, DESSUCURSAL, DESRUBRO
FROM            (SELECT        TOP (100) PERCENT CD.CODIGO, RTRIM(ISNULL(P.DESPRODUCTO, '')) + ' ' + LTRIM(ISNULL(CD.DESCODIGO1, '')) + + LTRIM(ISNULL(CD.DESCODIGO2, 
                                                    '')) AS PRODUCTO, M.CANTIDAD, M.CONCEPTO, M.CODCODIGO, M.CODDEPOSITO AS CODSUCURSAL, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, 
                                                    CONVERT(DATETIME, CAST(M.FECHAMOVIMIENTO AS VARCHAR(11)), 103) AS FECHAMTO, CASE WHEN (M.CANTIDAD &gt; 0 AND (M.CONCEPTO) 
                                                    = 'STOCK INICIAL' AND M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS STOCKINICIAL, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD ELSE 0 END AS COMPRA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD ELSE 0 END AS DEVOLUCIONCLIENTE, CASE WHEN (M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND 
                                                    M.MODULO = 13) THEN M.CANTIDAD ELSE 0 END AS TRANSFERENCIAENTRADA, CASE WHEN ((M.MODULO = 13 OR
                                                    M.MODULO = 28) AND M.CANTIDAD &gt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%') THEN M.CANTIDAD ELSE 0 END AS AJUSTEENTRADA, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 28 AND M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD ELSE 0 END AS ENTRPROD, 
                                                    CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 8) THEN M.CANTIDAD ELSE 0 END AS ANULVTA, CASE WHEN (M.CANTIDAD &gt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD ELSE 0 END AS ANULDEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 8) THEN M.CANTIDAD * - 1 ELSE 0 END AS VENTA,
                                                     CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'TRANSF%' AND M.MODULO = 13) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS TRANSFERENCIASALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND UPPER(M.CONCEPTO) LIKE 'AJUSTE%' AND 
                                                    (M.MODULO = 13 OR
                                                    M.MODULO = 28)) THEN M.CANTIDAD * - 1 ELSE 0 END AS AJUSTESALIDA, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 28 AND 
                                                    M.TIPOPRODUCCION &lt;&gt; 3) THEN M.CANTIDAD * - 1 ELSE 0 END AS SALPROD, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 29) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS DEVCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 3) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULCOMP, CASE WHEN (M.CANTIDAD &lt; 0 AND M.MODULO = 11) 
                                                    THEN M.CANTIDAD * - 1 ELSE 0 END AS ANULDEVVTA, dbo.SUCURSAL.DESSUCURSAL, P.CODRUBRO, dbo.RUBRO.DESRUBRO
                          FROM            dbo.MOVPRODUCTO AS M INNER JOIN
                                                    dbo.CODIGOS AS CD ON M.CODCODIGO = CD.CODCODIGO INNER JOIN
                                                    dbo.PRODUCTOS AS P ON CD.CODPRODUCTO = P.CODPRODUCTO LEFT OUTER JOIN
                                                    dbo.FAMILIA ON P.CODFAMILIA = dbo.FAMILIA.CODFAMILIA LEFT OUTER JOIN
                                                    dbo.LINEA ON P.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                    dbo.SUCURSAL ON M.CODDEPOSITO = dbo.SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                                                    dbo.RUBRO ON P.CODRUBRO = dbo.RUBRO.CODRUBRO AND dbo.LINEA.CODLINEA = dbo.RUBRO.CODLINEA) AS Subconsulta
WHERE        (CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103) &gt;= CONVERT(DATETIME, @FechaIni, 103)) AND (CONVERT(DATETIME, 
                         CAST(FECHAMTO AS VARCHAR(11)), 103) &lt;= CONVERT(DATETIME, @FechaFin, 103)) AND (CODSUCURSAL IN (SELECT        item FROM            dbo.fnPartir(@SUC, ',') AS fnPartir_1))
GROUP BY CODIGO, PRODUCTO, CODSUCURSAL, DESFAMILIA, DESLINEA, CODCODIGO, CONVERT(DATETIME, CAST(FECHAMTO AS VARCHAR(11)), 103), DESSUCURSAL, 
                         CODRUBRO, DESRUBRO
ORDER BY CODCODIGO, CODSUCURSAL, FECHAMTO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaIni" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaIni" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="FechaFin" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="DateTime" Direction="Input" ParameterName="@FechaFin" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="SUC" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@SUC" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RIProductosTableAdapter" GeneratorDataComponentClassName="RIProductosTableAdapter" Name="RIProductos" UserDataComponentName="RIProductosTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT PRODUCTOS.DESPRODUCTO + ' ' + CODIGOS.DESCODIGO1 AS Descripcion, RUBRO.DESRUBRO, LINEA.DESLINEA, 
                         PRODUCTOS.CODPRODUCTO, FAMILIA.DESFAMILIA, CODIGOS.CODIGO, CODIGOS.CODCODIGO
FROM            PRODUCTOS INNER JOIN
                         CODIGOS ON PRODUCTOS.CODPRODUCTO = CODIGOS.CODPRODUCTO LEFT OUTER JOIN
                         RUBRO ON PRODUCTOS.CODRUBRO = RUBRO.CODRUBRO LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA LEFT OUTER JOIN
                         LINEA ON PRODUCTOS.CODLINEA = LINEA.CODLINEA
ORDER BY Descripcion</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="Descripcion" DataSetColumn="Descripcion" />
              <Mapping SourceColumn="DESRUBRO" DataSetColumn="DESRUBRO" />
              <Mapping SourceColumn="DESLINEA" DataSetColumn="DESLINEA" />
              <Mapping SourceColumn="CODPRODUCTO" DataSetColumn="CODPRODUCTO" />
              <Mapping SourceColumn="DESFAMILIA" DataSetColumn="DESFAMILIA" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="CODCODIGO" DataSetColumn="CODCODIGO" />
            </Mappings>
            <Sources />
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RIStockActualTableAdapter" GeneratorDataComponentClassName="RIStockActualTableAdapter" Name="RIStockActual" UserDataComponentName="RIStockActualTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillTP" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetDataTP" GeneratorSourceName="FillTP" GetMethodModifier="Public" GetMethodName="GetDataTP" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetDataTP" UserSourceName="FillTP">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        UNIDADMEDIDA.DESMEDIDA, FAMILIA.DESFAMILIA, LINEA.DESLINEA, CODIGOS.CODIGO, STOCKDEPOSITO.STOCKACTUAL, SUCURSAL.DESSUCURSAL, 
                         RUBRO.DESRUBRO, RTRIM(PRODUCTOS.DESPRODUCTO) + ' ' + LTRIM(CODIGOS.DESCODIGO1) AS PRODUCTO, CODIGOS.CODCODIGO
FROM            STOCKDEPOSITO INNER JOIN
                         CODIGOS ON STOCKDEPOSITO.CODCODIGO = CODIGOS.CODCODIGO LEFT OUTER JOIN
                         PRODUCTOS ON PRODUCTOS.CODPRODUCTO = CODIGOS.CODPRODUCTO LEFT OUTER JOIN
                         SUCURSAL ON STOCKDEPOSITO.CODDEPOSITO = SUCURSAL.CODSUCURSAL LEFT OUTER JOIN
                         FAMILIA ON FAMILIA.CODFAMILIA = PRODUCTOS.CODFAMILIA LEFT OUTER JOIN
                         RUBRO ON PRODUCTOS.CODRUBRO = RUBRO.CODRUBRO LEFT OUTER JOIN
                         LINEA ON PRODUCTOS.CODLINEA = LINEA.CODLINEA AND FAMILIA.CODFAMILIA = PRODUCTOS.CODFAMILIA LEFT OUTER JOIN
                         UNIDADMEDIDA ON UNIDADMEDIDA.CODMEDIDA = PRODUCTOS.CODMEDIDA
</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="DESMEDIDA" DataSetColumn="DESMEDIDA" />
              <Mapping SourceColumn="DESFAMILIA" DataSetColumn="DESFAMILIA" />
              <Mapping SourceColumn="DESLINEA" DataSetColumn="DESLINEA" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="STOCKACTUAL" DataSetColumn="STOCKACTUAL" />
              <Mapping SourceColumn="DESSUCURSAL" DataSetColumn="DESSUCURSAL" />
              <Mapping SourceColumn="DESRUBRO" DataSetColumn="DESRUBRO" />
              <Mapping SourceColumn="PRODUCTO" DataSetColumn="PRODUCTO" />
              <Mapping SourceColumn="CODCODIGO" DataSetColumn="CODCODIGO" />
            </Mappings>
            <Sources />
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RIStockMinimoTableAdapter" GeneratorDataComponentClassName="RIStockMinimoTableAdapter" Name="RIStockMinimo" UserDataComponentName="RIStockMinimoTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBySuc" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetDataBySuc" GeneratorSourceName="FillBySuc" GetMethodModifier="Public" GetMethodName="GetDataBySuc" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetDataBySuc" UserSourceName="FillBySuc">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        RTRIM(PRODUCTOS.DESPRODUCTO) AS PRODUCTO, FAMILIA.DESFAMILIA AS CATEGORIA, LINEA.DESLINEA AS LINEA, RUBRO.DESRUBRO AS MARCA, 
                         ISNULL(PRODUCTOS.STOCKMINIMO, 0) AS STOCKMINIMO, ISNULL(PRODUCTOS.STOCKMAXIMO, 0) AS STOCKMAXIMO, CODIGOS.CODCODIGO, 
                         CODIGOS.CODPRODUCTO, ISNULL(STOCKDEPOSITO.STOCKACTUAL, 0) AS STOCKACTUAL, UNIDADMEDIDA.DESMEDIDA AS MEDIDA, SUCURSAL.DESSUCURSAL, 
                         CODIGOS.CODIGO
FROM            STOCKDEPOSITO INNER JOIN
                         SUCURSAL ON SUCURSAL.CODSUCURSAL = STOCKDEPOSITO.CODDEPOSITO LEFT OUTER JOIN
                         PRODUCTOS LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA LEFT OUTER JOIN
                         LINEA ON PRODUCTOS.CODLINEA = LINEA.CODLINEA AND FAMILIA.CODFAMILIA = LINEA.CODFAMILIA LEFT OUTER JOIN
                         RUBRO ON PRODUCTOS.CODRUBRO = RUBRO.CODRUBRO AND LINEA.CODLINEA = RUBRO.CODLINEA LEFT OUTER JOIN
                         CODIGOS ON PRODUCTOS.CODPRODUCTO = CODIGOS.CODPRODUCTO ON STOCKDEPOSITO.CODCODIGO = CODIGOS.CODCODIGO AND 
                         STOCKDEPOSITO.STOCKACTUAL &lt;= PRODUCTOS.STOCKMINIMO LEFT OUTER JOIN
                         UNIDADMEDIDA ON UNIDADMEDIDA.CODMEDIDA = PRODUCTOS.CODMEDIDA
WHERE        (PRODUCTOS.ESTADO = 0) AND (PRODUCTOS.SERVICIO = 0) AND (SUCURSAL.CODSUCURSAL IN
                             (SELECT        item
                               FROM            dbo.fnPartir(@suc, ',') AS fnPartir_1))</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="suc" ColumnName="" DataSourceName="" DataTypeServer="varchar(8000)" DbType="AnsiString" Direction="Input" ParameterName="@suc" Precision="0" Scale="0" Size="1024" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="PRODUCTO" DataSetColumn="PRODUCTO" />
              <Mapping SourceColumn="CATEGORIA" DataSetColumn="CATEGORIA" />
              <Mapping SourceColumn="LINEA" DataSetColumn="LINEA" />
              <Mapping SourceColumn="MARCA" DataSetColumn="MARCA" />
              <Mapping SourceColumn="STOCKMINIMO" DataSetColumn="STOCKMINIMO" />
              <Mapping SourceColumn="STOCKMAXIMO" DataSetColumn="STOCKMAXIMO" />
              <Mapping SourceColumn="CODCODIGO" DataSetColumn="CODCODIGO" />
              <Mapping SourceColumn="STOCKACTUAL" DataSetColumn="STOCKACTUAL" />
              <Mapping SourceColumn="MEDIDA" DataSetColumn="MEDIDA" />
              <Mapping SourceColumn="DESSUCURSAL" DataSetColumn="DESSUCURSAL" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="CODPRODUCTO" DataSetColumn="CODPRODUCTO1" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        RTRIM(PRODUCTOS.DESPRODUCTO) AS PRODUCTO, FAMILIA.DESFAMILIA AS CATEGORIA, LINEA.DESLINEA AS LINEA, RUBRO.DESRUBRO AS MARCA, 
                         ISNULL(PRODUCTOS.STOCKMINIMO, 0) AS STOCKMINIMO, ISNULL(PRODUCTOS.STOCKMAXIMO, 0) AS STOCKMAXIMO, CODIGOS.CODCODIGO, 
                         CODIGOS.CODPRODUCTO, ISNULL(STOCKDEPOSITO.STOCKACTUAL, 0) AS STOCKACTUAL, UNIDADMEDIDA.DESMEDIDA AS MEDIDA, SUCURSAL.DESSUCURSAL, 
                         CODIGOS.CODIGO
FROM            STOCKDEPOSITO INNER JOIN
                         SUCURSAL ON SUCURSAL.CODSUCURSAL = STOCKDEPOSITO.CODDEPOSITO LEFT OUTER JOIN
                         PRODUCTOS LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA LEFT OUTER JOIN
                         LINEA ON PRODUCTOS.CODLINEA = LINEA.CODLINEA AND FAMILIA.CODFAMILIA = LINEA.CODFAMILIA LEFT OUTER JOIN
                         RUBRO ON PRODUCTOS.CODRUBRO = RUBRO.CODRUBRO AND LINEA.CODLINEA = RUBRO.CODLINEA LEFT OUTER JOIN
                         CODIGOS ON PRODUCTOS.CODPRODUCTO = CODIGOS.CODPRODUCTO ON STOCKDEPOSITO.CODCODIGO = CODIGOS.CODCODIGO AND 
                         STOCKDEPOSITO.STOCKACTUAL &lt;= PRODUCTOS.STOCKMINIMO LEFT OUTER JOIN
                         UNIDADMEDIDA ON UNIDADMEDIDA.CODMEDIDA = PRODUCTOS.CODMEDIDA
WHERE        (PRODUCTOS.ESTADO = 0) AND (PRODUCTOS.SERVICIO = 0)</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RIOrdenPorCategoriaTableAdapter" GeneratorDataComponentClassName="RIOrdenPorCategoriaTableAdapter" Name="RIOrdenPorCategoria" UserDataComponentName="RIOrdenPorCategoriaTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        RTRIM(PRODUCTOS.DESPRODUCTO) AS PRODUCTO, ISNULL(FAMILIA.DESFAMILIA, 'Sin Familia') AS CATEGORIA, ISNULL(LINEA.DESLINEA, 'Sin Linea') AS LINEA, 
                         ISNULL(RUBRO.DESRUBRO, 'Sin Marca') AS MARCA, UNIDADMEDIDA.DESMEDIDA AS MEDIDA, PRODUCTOS.SERVICIO, SUCURSAL.DESSUCURSAL
FROM            SUCURSAL INNER JOIN
                         STOCKDEPOSITO ON SUCURSAL.CODSUCURSAL = STOCKDEPOSITO.CODDEPOSITO RIGHT OUTER JOIN
                         PRODUCTOS LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA LEFT OUTER JOIN
                         LINEA ON PRODUCTOS.CODLINEA = LINEA.CODLINEA AND FAMILIA.CODFAMILIA = LINEA.CODFAMILIA LEFT OUTER JOIN
                         RUBRO ON PRODUCTOS.CODRUBRO = RUBRO.CODRUBRO AND LINEA.CODLINEA = RUBRO.CODLINEA LEFT OUTER JOIN
                         CODIGOS ON PRODUCTOS.CODPRODUCTO = CODIGOS.CODPRODUCTO ON STOCKDEPOSITO.CODCODIGO = CODIGOS.CODCODIGO  LEFT OUTER JOIN
                         UNIDADMEDIDA ON UNIDADMEDIDA.CODMEDIDA = PRODUCTOS.CODMEDIDA
WHERE        (PRODUCTOS.ESTADO = 0) AND (PRODUCTOS.SERVICIO &lt;&gt; 1)
GROUP BY FAMILIA.DESFAMILIA, LINEA.DESLINEA, RUBRO.DESRUBRO, PRODUCTOS.DESPRODUCTO, CODIGOS.DESCODIGO1, CODIGOS.DESCODIGO2, 
                         UNIDADMEDIDA.DESMEDIDA, PRODUCTOS.SERVICIO, SUCURSAL.DESSUCURSAL</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="PRODUCTO" DataSetColumn="PRODUCTO" />
              <Mapping SourceColumn="CATEGORIA" DataSetColumn="CATEGORIA" />
              <Mapping SourceColumn="LINEA" DataSetColumn="LINEA" />
              <Mapping SourceColumn="MARCA" DataSetColumn="MARCA" />
              <Mapping SourceColumn="MEDIDA" DataSetColumn="MEDIDA" />
              <Mapping SourceColumn="SERVICIO" DataSetColumn="SERVICIO" />
              <Mapping SourceColumn="DESSUCURSAL" DataSetColumn="DESSUCURSAL" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBySucursal" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBySucursal" GeneratorSourceName="FillBySucursal" GetMethodModifier="Public" GetMethodName="GetDataBySucursal" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBySucursal" UserSourceName="FillBySucursal">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        RTRIM(PRODUCTOS.DESPRODUCTO) AS PRODUCTO, ISNULL(FAMILIA.DESFAMILIA, 'Sin Familia') AS CATEGORIA, ISNULL(LINEA.DESLINEA, 'Sin Linea') AS LINEA, 
                         ISNULL(RUBRO.DESRUBRO, 'Sin Marca') AS MARCA, UNIDADMEDIDA.DESMEDIDA AS MEDIDA, PRODUCTOS.SERVICIO, SUCURSAL.DESSUCURSAL
FROM            SUCURSAL INNER JOIN
                         STOCKDEPOSITO ON SUCURSAL.CODSUCURSAL = STOCKDEPOSITO.CODDEPOSITO RIGHT OUTER JOIN
                         PRODUCTOS LEFT OUTER JOIN
                         FAMILIA ON PRODUCTOS.CODFAMILIA = FAMILIA.CODFAMILIA LEFT OUTER JOIN
                         LINEA ON PRODUCTOS.CODLINEA = LINEA.CODLINEA AND FAMILIA.CODFAMILIA = LINEA.CODFAMILIA LEFT OUTER JOIN
                         RUBRO ON PRODUCTOS.CODRUBRO = RUBRO.CODRUBRO AND LINEA.CODLINEA = RUBRO.CODLINEA LEFT OUTER JOIN
                         CODIGOS ON PRODUCTOS.CODPRODUCTO = CODIGOS.CODPRODUCTO ON STOCKDEPOSITO.CODCODIGO = CODIGOS.CODCODIGO LEFT OUTER JOIN
                         UNIDADMEDIDA ON UNIDADMEDIDA.CODMEDIDA = PRODUCTOS.CODMEDIDA
WHERE        (PRODUCTOS.ESTADO = 0) AND (PRODUCTOS.SERVICIO &lt;&gt; 1) AND SUCURSAL.DESSUCURSAL = @suc
GROUP BY FAMILIA.DESFAMILIA, LINEA.DESLINEA, RUBRO.DESRUBRO, PRODUCTOS.DESPRODUCTO, CODIGOS.DESCODIGO1, CODIGOS.DESCODIGO2, 
                         UNIDADMEDIDA.DESMEDIDA, PRODUCTOS.SERVICIO, SUCURSAL.DESSUCURSAL</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="suc" ColumnName="DESSUCURSAL" DataSourceName="Guazu.dbo.SUCURSAL" DataTypeServer="varchar(50)" DbType="AnsiString" Direction="Input" ParameterName="@suc" Precision="0" ProviderType="VarChar" Scale="0" Size="50" SourceColumn="DESSUCURSAL" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RICostoPromedioTableAdapter" GeneratorDataComponentClassName="RICostoPromedioTableAdapter" Name="RICostoPromedio" UserDataComponentName="RICostoPromedioTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="SELECT dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, dbo.RUBRO.DESRUBRO, dbo.UNIDADMEDIDA.DESMEDIDA, dbo.CODIGOS.CODIGO, dbo.SUCURSAL.DESSUCURSAL, RTRIM(dbo.PRODUCTOS.DESPRODUCTO) + ' ' + LTRIM(dbo.CODIGOS.DESCODIGO1) AS PRODUCTO, dbo.COMPRASDETALLE.CANTIDADCOMPRA AS Cantidad, dbo.COMPRASDETALLE.CANTIDADCOMPRA * dbo.COMPRASDETALLE.COSTOUNITARIO AS TotalUni FROM dbo.PRODUCTOS INNER JOIN dbo.CODIGOS ON dbo.PRODUCTOS.CODPRODUCTO = dbo.CODIGOS.CODPRODUCTO LEFT OUTER JOIN dbo.SUCURSAL LEFT OUTER JOIN dbo.COMPRAS LEFT OUTER JOIN dbo.COMPRASDETALLE ON dbo.COMPRAS.CODCOMPRA = dbo.COMPRASDETALLE.CODCOMPRA ON dbo.SUCURSAL.CODSUCURSAL = dbo.COMPRAS.CODSUCURSAL ON dbo.CODIGOS.CODCODIGO = dbo.COMPRASDETALLE.CODCODIGO LEFT OUTER JOIN dbo.UNIDADMEDIDA ON dbo.PRODUCTOS.CODMEDIDA = dbo.UNIDADMEDIDA.CODMEDIDA LEFT OUTER JOIN dbo.RUBRO ON dbo.PRODUCTOS.CODRUBRO = dbo.RUBRO.CODRUBRO LEFT OUTER JOIN dbo.LINEA ON dbo.PRODUCTOS.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN dbo.FAMILIA ON dbo.PRODUCTOS.CODFAMILIA = dbo.FAMILIA.CODFAMILIA WHERE (dbo.PRODUCTOS.SERVICIO &lt;&gt; 1) AND (dbo.PRODUCTOS.ESTADO = 0) GROUP BY dbo.CODIGOS.CODIGO, RTRIM(dbo.PRODUCTOS.DESPRODUCTO) + ' ' + LTRIM(dbo.CODIGOS.DESCODIGO1), dbo.SUCURSAL.DESSUCURSAL, dbo.RUBRO.DESRUBRO, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, dbo.UNIDADMEDIDA.DESMEDIDA, dbo.COMPRASDETALLE.CANTIDADCOMPRA, dbo.COMPRASDETALLE.COSTOUNITARIO" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        DESFAMILIA, DESLINEA, DESRUBRO, DESMEDIDA, CODIGO, DESSUCURSAL, PRODUCTO, CASE WHEN SUM(Cantidad) IS NULL THEN 0 ELSE SUM(Cantidad) 
                         END AS Cantidad, CASE WHEN SUM(TotalUni) IS NULL THEN 0 ELSE SUM(TotalUni) END AS TotalUni
FROM            (SELECT        dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, dbo.RUBRO.DESRUBRO, dbo.UNIDADMEDIDA.DESMEDIDA, dbo.CODIGOS.CODIGO, 
                                                    dbo.SUCURSAL.DESSUCURSAL, RTRIM(dbo.PRODUCTOS.DESPRODUCTO) + ' ' + LTRIM(dbo.CODIGOS.DESCODIGO1) AS PRODUCTO, 
                                                    dbo.COMPRASDETALLE.CANTIDADCOMPRA AS Cantidad, 
                                                    dbo.COMPRASDETALLE.CANTIDADCOMPRA * dbo.COMPRASDETALLE.COSTOUNITARIO AS TotalUni
                          FROM            dbo.PRODUCTOS INNER JOIN
                                                    dbo.CODIGOS ON dbo.PRODUCTOS.CODPRODUCTO = dbo.CODIGOS.CODPRODUCTO LEFT OUTER JOIN
                                                    dbo.SUCURSAL LEFT OUTER JOIN
                                                    dbo.COMPRAS LEFT OUTER JOIN
                                                    dbo.COMPRASDETALLE ON dbo.COMPRAS.CODCOMPRA = dbo.COMPRASDETALLE.CODCOMPRA ON 
                                                    dbo.SUCURSAL.CODSUCURSAL = dbo.COMPRAS.CODSUCURSAL ON 
                                                    dbo.CODIGOS.CODCODIGO = dbo.COMPRASDETALLE.CODCODIGO LEFT OUTER JOIN
                                                    dbo.UNIDADMEDIDA ON dbo.PRODUCTOS.CODMEDIDA = dbo.UNIDADMEDIDA.CODMEDIDA LEFT OUTER JOIN
                                                    dbo.RUBRO ON dbo.PRODUCTOS.CODRUBRO = dbo.RUBRO.CODRUBRO LEFT OUTER JOIN
                                                    dbo.LINEA ON dbo.PRODUCTOS.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                                                    dbo.FAMILIA ON dbo.PRODUCTOS.CODFAMILIA = dbo.FAMILIA.CODFAMILIA
                          WHERE        (dbo.PRODUCTOS.SERVICIO &lt;&gt; 1) AND (dbo.PRODUCTOS.ESTADO = 0)
                          GROUP BY dbo.CODIGOS.CODIGO, RTRIM(dbo.PRODUCTOS.DESPRODUCTO) + ' ' + LTRIM(dbo.CODIGOS.DESCODIGO1), dbo.SUCURSAL.DESSUCURSAL, 
                                                    dbo.RUBRO.DESRUBRO, dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, dbo.UNIDADMEDIDA.DESMEDIDA, 
                                                    dbo.COMPRASDETALLE.CANTIDADCOMPRA, dbo.COMPRASDETALLE.COSTOUNITARIO) AS Subconsulta
GROUP BY CODIGO, PRODUCTO, DESSUCURSAL, DESRUBRO, DESFAMILIA, DESLINEA, DESMEDIDA</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="DESFAMILIA" DataSetColumn="DESFAMILIA" />
              <Mapping SourceColumn="DESLINEA" DataSetColumn="DESLINEA" />
              <Mapping SourceColumn="DESRUBRO" DataSetColumn="DESRUBRO" />
              <Mapping SourceColumn="DESMEDIDA" DataSetColumn="DESMEDIDA" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="DESSUCURSAL" DataSetColumn="DESSUCURSAL" />
              <Mapping SourceColumn="PRODUCTO" DataSetColumn="PRODUCTO" />
              <Mapping SourceColumn="Cantidad" DataSetColumn="Cantidad" />
              <Mapping SourceColumn="TotalUni" DataSetColumn="TotalUni" />
            </Mappings>
            <Sources />
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RIPrecioTableAdapter" GeneratorDataComponentClassName="RIPrecioTableAdapter" Name="RIPrecio" UserDataComponentName="RIPrecioTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        CODIGOS.CODIGO, PRECIO.PRECIOVENTA, PRECIO.CODTIPOCLIENTE, TIPOCLIENTE.DESTIPOCLIENTE
FROM            PRODUCTOS LEFT OUTER JOIN
                         PRECIO ON PRECIO.CODPRODUCTO = PRODUCTOS.CODPRODUCTO INNER JOIN
                         CODIGOS ON PRODUCTOS.CODPRODUCTO = CODIGOS.CODPRODUCTO INNER JOIN
                         TIPOCLIENTE ON PRECIO.CODTIPOCLIENTE = TIPOCLIENTE.CODTIPOCLIENTE
GROUP BY CODIGOS.CODIGO, PRECIO.PRECIOVENTA, PRECIO.CODTIPOCLIENTE, TIPOCLIENTE.DESTIPOCLIENTE
ORDER BY CODIGOS.CODIGO</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="PRECIOVENTA" DataSetColumn="PRECIOVENTA" />
              <Mapping SourceColumn="CODTIPOCLIENTE" DataSetColumn="CODTIPOCLIENTE" />
              <Mapping SourceColumn="DESTIPOCLIENTE" DataSetColumn="DESTIPOCLIENTE" />
            </Mappings>
            <Sources />
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RIStockDepositoTableAdapter" GeneratorDataComponentClassName="RIStockDepositoTableAdapter" Name="RIStockDeposito" UserDataComponentName="RIStockDepositoTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectName="Guazu.dbo.CODIGOS" DbObjectType="Table" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        SUM(STOCKDEPOSITO.STOCKACTUAL) AS Expr1, CODIGOS.CODIGO
FROM            STOCKDEPOSITO INNER JOIN
                         CODIGOS ON STOCKDEPOSITO.CODCODIGO = CODIGOS.CODCODIGO
GROUP BY CODIGOS.CODIGO</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="Expr1" DataSetColumn="Expr1" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
            </Mappings>
            <Sources />
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="RIListadoCostoTableAdapter" GeneratorDataComponentClassName="RIListadoCostoTableAdapter" Name="RIListadoCosto" UserDataComponentName="RIListadoCostoTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="GESTIONConnectionString2 (MySettings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        TOP (100) PERCENT dbo.CODIGOS.CODCODIGO, dbo.CODIGOS.CODIGO, dbo.PRODUCTOS.DESPRODUCTO, dbo.CODIGOS.PRECIO AS COSTO, 
                         dbo.FAMILIA.DESFAMILIA, dbo.LINEA.DESLINEA, dbo.RUBRO.DESRUBRO
FROM            dbo.CODIGOS INNER JOIN
                         dbo.PRODUCTOS ON dbo.CODIGOS.CODPRODUCTO = dbo.PRODUCTOS.CODPRODUCTO LEFT OUTER JOIN
                         dbo.RUBRO ON dbo.PRODUCTOS.CODRUBRO = dbo.RUBRO.CODRUBRO LEFT OUTER JOIN
                         dbo.LINEA ON dbo.PRODUCTOS.CODLINEA = dbo.LINEA.CODLINEA LEFT OUTER JOIN
                         dbo.FAMILIA ON dbo.PRODUCTOS.CODFAMILIA = dbo.FAMILIA.CODFAMILIA</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="CODCODIGO" DataSetColumn="CODCODIGO" />
              <Mapping SourceColumn="CODIGO" DataSetColumn="CODIGO" />
              <Mapping SourceColumn="DESPRODUCTO" DataSetColumn="DESPRODUCTO" />
              <Mapping SourceColumn="COSTO" DataSetColumn="COSTO" />
              <Mapping SourceColumn="DESFAMILIA" DataSetColumn="DESFAMILIA" />
              <Mapping SourceColumn="DESLINEA" DataSetColumn="DESLINEA" />
              <Mapping SourceColumn="DESRUBRO" DataSetColumn="DESRUBRO" />
            </Mappings>
            <Sources />
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="dsRVFiltroInventario" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msdata:EnforceConstraints="False" msprop:EnableTableAdapterManager="true" msprop:Generator_DataSetName="dsRVFiltroInventario" msprop:Generator_UserDSName="dsRVFiltroInventario">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="RVFISTOCKAUNAFECHA" msprop:Generator_TableClassName="RVFISTOCKAUNAFECHADataTable" msprop:Generator_TableVarName="tableRVFISTOCKAUNAFECHA" msprop:Generator_RowChangedName="RVFISTOCKAUNAFECHARowChanged" msprop:Generator_TablePropName="RVFISTOCKAUNAFECHA" msprop:Generator_RowDeletingName="RVFISTOCKAUNAFECHARowDeleting" msprop:Generator_RowChangingName="RVFISTOCKAUNAFECHARowChanging" msprop:Generator_RowEvHandlerName="RVFISTOCKAUNAFECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RVFISTOCKAUNAFECHARowDeleted" msprop:Generator_RowClassName="RVFISTOCKAUNAFECHARow" msprop:Generator_UserTableName="RVFISTOCKAUNAFECHA" msprop:Generator_RowEvArgName="RVFISTOCKAUNAFECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODCODIGO" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnCODCODIGO" msprop:Generator_ColumnPropNameInRow="CODCODIGO" msprop:Generator_ColumnPropNameInTable="CODCODIGOColumn" msprop:Generator_UserColumnName="CODCODIGO" type="xs:int" />
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESPRODUCTO" msprop:Generator_ColumnVarNameInTable="columnDESPRODUCTO" msprop:Generator_ColumnPropNameInRow="DESPRODUCTO" msprop:Generator_ColumnPropNameInTable="DESPRODUCTOColumn" msprop:Generator_UserColumnName="DESPRODUCTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESFAMILIA" msprop:Generator_ColumnVarNameInTable="columnDESFAMILIA" msprop:Generator_ColumnPropNameInRow="DESFAMILIA" msprop:Generator_ColumnPropNameInTable="DESFAMILIAColumn" msprop:Generator_UserColumnName="DESFAMILIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESMEDIDA" msprop:Generator_ColumnVarNameInTable="columnDESMEDIDA" msprop:Generator_ColumnPropNameInRow="DESMEDIDA" msprop:Generator_ColumnPropNameInTable="DESMEDIDAColumn" msprop:Generator_UserColumnName="DESMEDIDA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="STOCKFECHA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSTOCKFECHA" msprop:Generator_ColumnPropNameInRow="STOCKFECHA" msprop:Generator_ColumnPropNameInTable="STOCKFECHAColumn" msprop:Generator_UserColumnName="STOCKFECHA" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESSUCURSAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDESSUCURSAL" msprop:Generator_ColumnPropNameInRow="DESSUCURSAL" msprop:Generator_ColumnPropNameInTable="DESSUCURSALColumn" msprop:Generator_UserColumnName="DESSUCURSAL" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODSUCURSAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCODSUCURSAL" msprop:Generator_ColumnPropNameInRow="CODSUCURSAL" msprop:Generator_ColumnPropNameInTable="CODSUCURSALColumn" msprop:Generator_UserColumnName="CODSUCURSAL" type="xs:int" />
              <xs:element name="PRECIO" msprop:Generator_ColumnVarNameInTable="columnPRECIO" msprop:Generator_ColumnPropNameInRow="PRECIO" msprop:Generator_ColumnPropNameInTable="PRECIOColumn" msprop:Generator_UserColumnName="PRECIO" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RIMOVPRODUCTOXRANGOFECHA" msprop:Generator_TableClassName="RIMOVPRODUCTOXRANGOFECHADataTable" msprop:Generator_TableVarName="tableRIMOVPRODUCTOXRANGOFECHA" msprop:Generator_RowChangedName="RIMOVPRODUCTOXRANGOFECHARowChanged" msprop:Generator_TablePropName="RIMOVPRODUCTOXRANGOFECHA" msprop:Generator_RowDeletingName="RIMOVPRODUCTOXRANGOFECHARowDeleting" msprop:Generator_RowChangingName="RIMOVPRODUCTOXRANGOFECHARowChanging" msprop:Generator_RowEvHandlerName="RIMOVPRODUCTOXRANGOFECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RIMOVPRODUCTOXRANGOFECHARowDeleted" msprop:Generator_RowClassName="RIMOVPRODUCTOXRANGOFECHARow" msprop:Generator_UserTableName="RIMOVPRODUCTOXRANGOFECHA" msprop:Generator_RowEvArgName="RIMOVPRODUCTOXRANGOFECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PRODUCTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRODUCTO" msprop:Generator_ColumnPropNameInRow="PRODUCTO" msprop:Generator_ColumnPropNameInTable="PRODUCTOColumn" msprop:Generator_UserColumnName="PRODUCTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="281" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="STOCKINICIAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSTOCKINICIAL" msprop:Generator_ColumnPropNameInRow="STOCKINICIAL" msprop:Generator_ColumnPropNameInTable="STOCKINICIALColumn" msprop:Generator_UserColumnName="STOCKINICIAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="COMPRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCOMPRA" msprop:Generator_ColumnPropNameInRow="COMPRA" msprop:Generator_ColumnPropNameInTable="COMPRAColumn" msprop:Generator_UserColumnName="COMPRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="DEVOLUCIONCLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEVOLUCIONCLIENTE" msprop:Generator_ColumnPropNameInRow="DEVOLUCIONCLIENTE" msprop:Generator_ColumnPropNameInTable="DEVOLUCIONCLIENTEColumn" msprop:Generator_UserColumnName="DEVOLUCIONCLIENTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="TRANSFERENCIAENTRADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTRANSFERENCIAENTRADA" msprop:Generator_ColumnPropNameInRow="TRANSFERENCIAENTRADA" msprop:Generator_ColumnPropNameInTable="TRANSFERENCIAENTRADAColumn" msprop:Generator_UserColumnName="TRANSFERENCIAENTRADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="AJUSTEENTRADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAJUSTEENTRADA" msprop:Generator_ColumnPropNameInRow="AJUSTEENTRADA" msprop:Generator_ColumnPropNameInTable="AJUSTEENTRADAColumn" msprop:Generator_UserColumnName="AJUSTEENTRADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="ANULDEVCOMP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANULDEVCOMP" msprop:Generator_ColumnPropNameInRow="ANULDEVCOMP" msprop:Generator_ColumnPropNameInTable="ANULDEVCOMPColumn" msprop:Generator_UserColumnName="ANULDEVCOMP" type="xs:decimal" minOccurs="0" />
              <xs:element name="VENTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVENTA" msprop:Generator_ColumnPropNameInRow="VENTA" msprop:Generator_ColumnPropNameInTable="VENTAColumn" msprop:Generator_UserColumnName="VENTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="ENTRPROD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnENTRPROD" msprop:Generator_ColumnPropNameInRow="ENTRPROD" msprop:Generator_ColumnPropNameInTable="ENTRPRODColumn" msprop:Generator_UserColumnName="ENTRPROD" type="xs:decimal" minOccurs="0" />
              <xs:element name="ANULVTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANULVTA" msprop:Generator_ColumnPropNameInRow="ANULVTA" msprop:Generator_ColumnPropNameInTable="ANULVTAColumn" msprop:Generator_UserColumnName="ANULVTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALPROD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALPROD" msprop:Generator_ColumnPropNameInRow="SALPROD" msprop:Generator_ColumnPropNameInTable="SALPRODColumn" msprop:Generator_UserColumnName="SALPROD" type="xs:decimal" minOccurs="0" />
              <xs:element name="DEVCOMP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEVCOMP" msprop:Generator_ColumnPropNameInRow="DEVCOMP" msprop:Generator_ColumnPropNameInTable="DEVCOMPColumn" msprop:Generator_UserColumnName="DEVCOMP" type="xs:decimal" minOccurs="0" />
              <xs:element name="ANULCOMP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANULCOMP" msprop:Generator_ColumnPropNameInRow="ANULCOMP" msprop:Generator_ColumnPropNameInTable="ANULCOMPColumn" msprop:Generator_UserColumnName="ANULCOMP" type="xs:decimal" minOccurs="0" />
              <xs:element name="TRANSFERENCIASALIDA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTRANSFERENCIASALIDA" msprop:Generator_ColumnPropNameInRow="TRANSFERENCIASALIDA" msprop:Generator_ColumnPropNameInTable="TRANSFERENCIASALIDAColumn" msprop:Generator_UserColumnName="TRANSFERENCIASALIDA" type="xs:decimal" minOccurs="0" />
              <xs:element name="AJUSTESALIDA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAJUSTESALIDA" msprop:Generator_ColumnPropNameInRow="AJUSTESALIDA" msprop:Generator_ColumnPropNameInTable="AJUSTESALIDAColumn" msprop:Generator_UserColumnName="AJUSTESALIDA" type="xs:decimal" minOccurs="0" />
              <xs:element name="ANULDEVVTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANULDEVVTA" msprop:Generator_ColumnPropNameInRow="ANULDEVVTA" msprop:Generator_ColumnPropNameInTable="ANULDEVVTAColumn" msprop:Generator_UserColumnName="ANULDEVVTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODSUCURSAL" msprop:Generator_ColumnVarNameInTable="columnCODSUCURSAL" msprop:Generator_ColumnPropNameInRow="CODSUCURSAL" msprop:Generator_ColumnPropNameInTable="CODSUCURSALColumn" msprop:Generator_UserColumnName="CODSUCURSAL" type="xs:int" minOccurs="0" />
              <xs:element name="DESFAMILIA" msprop:Generator_ColumnVarNameInTable="columnDESFAMILIA" msprop:Generator_ColumnPropNameInRow="DESFAMILIA" msprop:Generator_ColumnPropNameInTable="DESFAMILIAColumn" msprop:Generator_UserColumnName="DESFAMILIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESLINEA" msprop:Generator_ColumnVarNameInTable="columnDESLINEA" msprop:Generator_ColumnPropNameInRow="DESLINEA" msprop:Generator_ColumnPropNameInTable="DESLINEAColumn" msprop:Generator_UserColumnName="DESLINEA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODCODIGO" msprop:Generator_ColumnVarNameInTable="columnCODCODIGO" msprop:Generator_ColumnPropNameInRow="CODCODIGO" msprop:Generator_ColumnPropNameInTable="CODCODIGOColumn" msprop:Generator_UserColumnName="CODCODIGO" type="xs:int" minOccurs="0" />
              <xs:element name="CODRUBRO" msprop:Generator_ColumnVarNameInTable="columnCODRUBRO" msprop:Generator_ColumnPropNameInRow="CODRUBRO" msprop:Generator_ColumnPropNameInTable="CODRUBROColumn" msprop:Generator_UserColumnName="CODRUBRO" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESSUCURSAL" msprop:Generator_ColumnVarNameInTable="columnDESSUCURSAL" msprop:Generator_ColumnPropNameInRow="DESSUCURSAL" msprop:Generator_ColumnPropNameInTable="DESSUCURSALColumn" msprop:Generator_UserColumnName="DESSUCURSAL" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESRUBRO" msprop:Generator_ColumnVarNameInTable="columnDESRUBRO" msprop:Generator_ColumnPropNameInRow="DESRUBRO" msprop:Generator_ColumnPropNameInTable="DESRUBROColumn" msprop:Generator_UserColumnName="DESRUBRO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RIMOVPRODUCTOPORFECHA" msprop:Generator_TableClassName="RIMOVPRODUCTOPORFECHADataTable" msprop:Generator_TableVarName="tableRIMOVPRODUCTOPORFECHA" msprop:Generator_RowChangedName="RIMOVPRODUCTOPORFECHARowChanged" msprop:Generator_TablePropName="RIMOVPRODUCTOPORFECHA" msprop:Generator_RowDeletingName="RIMOVPRODUCTOPORFECHARowDeleting" msprop:Generator_RowChangingName="RIMOVPRODUCTOPORFECHARowChanging" msprop:Generator_RowEvHandlerName="RIMOVPRODUCTOPORFECHARowChangeEventHandler" msprop:Generator_RowDeletedName="RIMOVPRODUCTOPORFECHARowDeleted" msprop:Generator_RowClassName="RIMOVPRODUCTOPORFECHARow" msprop:Generator_UserTableName="RIMOVPRODUCTOPORFECHA" msprop:Generator_RowEvArgName="RIMOVPRODUCTOPORFECHARowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PRODUCTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRODUCTO" msprop:Generator_ColumnPropNameInRow="PRODUCTO" msprop:Generator_ColumnPropNameInTable="PRODUCTOColumn" msprop:Generator_UserColumnName="PRODUCTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="281" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="STOCKINICIAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSTOCKINICIAL" msprop:Generator_ColumnPropNameInRow="STOCKINICIAL" msprop:Generator_ColumnPropNameInTable="STOCKINICIALColumn" msprop:Generator_UserColumnName="STOCKINICIAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="COMPRA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCOMPRA" msprop:Generator_ColumnPropNameInRow="COMPRA" msprop:Generator_ColumnPropNameInTable="COMPRAColumn" msprop:Generator_UserColumnName="COMPRA" type="xs:decimal" minOccurs="0" />
              <xs:element name="DEVOLUCIONCLIENTE" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEVOLUCIONCLIENTE" msprop:Generator_ColumnPropNameInRow="DEVOLUCIONCLIENTE" msprop:Generator_ColumnPropNameInTable="DEVOLUCIONCLIENTEColumn" msprop:Generator_UserColumnName="DEVOLUCIONCLIENTE" type="xs:decimal" minOccurs="0" />
              <xs:element name="TRANSFERENCIAENTRADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTRANSFERENCIAENTRADA" msprop:Generator_ColumnPropNameInRow="TRANSFERENCIAENTRADA" msprop:Generator_ColumnPropNameInTable="TRANSFERENCIAENTRADAColumn" msprop:Generator_UserColumnName="TRANSFERENCIAENTRADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="AJUSTEENTRADA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAJUSTEENTRADA" msprop:Generator_ColumnPropNameInRow="AJUSTEENTRADA" msprop:Generator_ColumnPropNameInTable="AJUSTEENTRADAColumn" msprop:Generator_UserColumnName="AJUSTEENTRADA" type="xs:decimal" minOccurs="0" />
              <xs:element name="ANULDEVCOMP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANULDEVCOMP" msprop:Generator_ColumnPropNameInRow="ANULDEVCOMP" msprop:Generator_ColumnPropNameInTable="ANULDEVCOMPColumn" msprop:Generator_UserColumnName="ANULDEVCOMP" type="xs:decimal" minOccurs="0" />
              <xs:element name="VENTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnVENTA" msprop:Generator_ColumnPropNameInRow="VENTA" msprop:Generator_ColumnPropNameInTable="VENTAColumn" msprop:Generator_UserColumnName="VENTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="ENTRPROD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnENTRPROD" msprop:Generator_ColumnPropNameInRow="ENTRPROD" msprop:Generator_ColumnPropNameInTable="ENTRPRODColumn" msprop:Generator_UserColumnName="ENTRPROD" type="xs:decimal" minOccurs="0" />
              <xs:element name="ANULVTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANULVTA" msprop:Generator_ColumnPropNameInRow="ANULVTA" msprop:Generator_ColumnPropNameInTable="ANULVTAColumn" msprop:Generator_UserColumnName="ANULVTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="SALPROD" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSALPROD" msprop:Generator_ColumnPropNameInRow="SALPROD" msprop:Generator_ColumnPropNameInTable="SALPRODColumn" msprop:Generator_UserColumnName="SALPROD" type="xs:decimal" minOccurs="0" />
              <xs:element name="DEVCOMP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDEVCOMP" msprop:Generator_ColumnPropNameInRow="DEVCOMP" msprop:Generator_ColumnPropNameInTable="DEVCOMPColumn" msprop:Generator_UserColumnName="DEVCOMP" type="xs:decimal" minOccurs="0" />
              <xs:element name="ANULCOMP" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANULCOMP" msprop:Generator_ColumnPropNameInRow="ANULCOMP" msprop:Generator_ColumnPropNameInTable="ANULCOMPColumn" msprop:Generator_UserColumnName="ANULCOMP" type="xs:decimal" minOccurs="0" />
              <xs:element name="TRANSFERENCIASALIDA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTRANSFERENCIASALIDA" msprop:Generator_ColumnPropNameInRow="TRANSFERENCIASALIDA" msprop:Generator_ColumnPropNameInTable="TRANSFERENCIASALIDAColumn" msprop:Generator_UserColumnName="TRANSFERENCIASALIDA" type="xs:decimal" minOccurs="0" />
              <xs:element name="AJUSTESALIDA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnAJUSTESALIDA" msprop:Generator_ColumnPropNameInRow="AJUSTESALIDA" msprop:Generator_ColumnPropNameInTable="AJUSTESALIDAColumn" msprop:Generator_UserColumnName="AJUSTESALIDA" type="xs:decimal" minOccurs="0" />
              <xs:element name="ANULDEVVTA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnANULDEVVTA" msprop:Generator_ColumnPropNameInRow="ANULDEVVTA" msprop:Generator_ColumnPropNameInTable="ANULDEVVTAColumn" msprop:Generator_UserColumnName="ANULDEVVTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODSUCURSAL" msprop:Generator_ColumnVarNameInTable="columnCODSUCURSAL" msprop:Generator_ColumnPropNameInRow="CODSUCURSAL" msprop:Generator_ColumnPropNameInTable="CODSUCURSALColumn" msprop:Generator_UserColumnName="CODSUCURSAL" type="xs:int" minOccurs="0" />
              <xs:element name="DESFAMILIA" msprop:Generator_ColumnVarNameInTable="columnDESFAMILIA" msprop:Generator_ColumnPropNameInRow="DESFAMILIA" msprop:Generator_ColumnPropNameInTable="DESFAMILIAColumn" msprop:Generator_UserColumnName="DESFAMILIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESLINEA" msprop:Generator_ColumnVarNameInTable="columnDESLINEA" msprop:Generator_ColumnPropNameInRow="DESLINEA" msprop:Generator_ColumnPropNameInTable="DESLINEAColumn" msprop:Generator_UserColumnName="DESLINEA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODCODIGO" msprop:Generator_ColumnVarNameInTable="columnCODCODIGO" msprop:Generator_ColumnPropNameInRow="CODCODIGO" msprop:Generator_ColumnPropNameInTable="CODCODIGOColumn" msprop:Generator_UserColumnName="CODCODIGO" type="xs:int" minOccurs="0" />
              <xs:element name="CODRUBRO" msprop:Generator_ColumnVarNameInTable="columnCODRUBRO" msprop:Generator_ColumnPropNameInRow="CODRUBRO" msprop:Generator_ColumnPropNameInTable="CODRUBROColumn" msprop:Generator_UserColumnName="CODRUBRO" type="xs:decimal" minOccurs="0" />
              <xs:element name="FECHAMTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnFECHAMTO" msprop:Generator_ColumnPropNameInRow="FECHAMTO" msprop:Generator_ColumnPropNameInTable="FECHAMTOColumn" msprop:Generator_UserColumnName="FECHAMTO" type="xs:dateTime" minOccurs="0" />
              <xs:element name="DESSUCURSAL" msprop:Generator_ColumnVarNameInTable="columnDESSUCURSAL" msprop:Generator_ColumnPropNameInRow="DESSUCURSAL" msprop:Generator_ColumnPropNameInTable="DESSUCURSALColumn" msprop:Generator_UserColumnName="DESSUCURSAL" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESRUBRO" msprop:Generator_ColumnVarNameInTable="columnDESRUBRO" msprop:Generator_ColumnPropNameInRow="DESRUBRO" msprop:Generator_ColumnPropNameInTable="DESRUBROColumn" msprop:Generator_UserColumnName="DESRUBRO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RIProductos" msprop:Generator_TableClassName="RIProductosDataTable" msprop:Generator_TableVarName="tableRIProductos" msprop:Generator_RowChangedName="RIProductosRowChanged" msprop:Generator_TablePropName="RIProductos" msprop:Generator_RowDeletingName="RIProductosRowDeleting" msprop:Generator_RowChangingName="RIProductosRowChanging" msprop:Generator_RowEvHandlerName="RIProductosRowChangeEventHandler" msprop:Generator_RowDeletedName="RIProductosRowDeleted" msprop:Generator_RowClassName="RIProductosRow" msprop:Generator_UserTableName="RIProductos" msprop:Generator_RowEvArgName="RIProductosRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="Descripcion" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnDescripcion" msprop:Generator_ColumnPropNameInRow="Descripcion" msprop:Generator_ColumnPropNameInTable="DescripcionColumn" msprop:Generator_UserColumnName="Descripcion" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="181" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESRUBRO" msprop:Generator_ColumnVarNameInTable="columnDESRUBRO" msprop:Generator_ColumnPropNameInRow="DESRUBRO" msprop:Generator_ColumnPropNameInTable="DESRUBROColumn" msprop:Generator_UserColumnName="DESRUBRO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESLINEA" msprop:Generator_ColumnVarNameInTable="columnDESLINEA" msprop:Generator_ColumnPropNameInRow="DESLINEA" msprop:Generator_ColumnPropNameInTable="DESLINEAColumn" msprop:Generator_UserColumnName="DESLINEA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODPRODUCTO" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnCODPRODUCTO" msprop:Generator_ColumnPropNameInRow="CODPRODUCTO" msprop:Generator_ColumnPropNameInTable="CODPRODUCTOColumn" msprop:Generator_UserColumnName="CODPRODUCTO" type="xs:decimal" />
              <xs:element name="DESFAMILIA" msprop:Generator_ColumnVarNameInTable="columnDESFAMILIA" msprop:Generator_ColumnPropNameInRow="DESFAMILIA" msprop:Generator_ColumnPropNameInTable="DESFAMILIAColumn" msprop:Generator_UserColumnName="DESFAMILIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODCODIGO" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnCODCODIGO" msprop:Generator_ColumnPropNameInRow="CODCODIGO" msprop:Generator_ColumnPropNameInTable="CODCODIGOColumn" msprop:Generator_UserColumnName="CODCODIGO" type="xs:int" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RIStockActual" msprop:Generator_TableClassName="RIStockActualDataTable" msprop:Generator_TableVarName="tableRIStockActual" msprop:Generator_RowChangedName="RIStockActualRowChanged" msprop:Generator_TablePropName="RIStockActual" msprop:Generator_RowDeletingName="RIStockActualRowDeleting" msprop:Generator_RowChangingName="RIStockActualRowChanging" msprop:Generator_RowEvHandlerName="RIStockActualRowChangeEventHandler" msprop:Generator_RowDeletedName="RIStockActualRowDeleted" msprop:Generator_RowClassName="RIStockActualRow" msprop:Generator_UserTableName="RIStockActual" msprop:Generator_RowEvArgName="RIStockActualRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="DESMEDIDA" msprop:Generator_ColumnVarNameInTable="columnDESMEDIDA" msprop:Generator_ColumnPropNameInRow="DESMEDIDA" msprop:Generator_ColumnPropNameInTable="DESMEDIDAColumn" msprop:Generator_UserColumnName="DESMEDIDA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESFAMILIA" msprop:Generator_ColumnVarNameInTable="columnDESFAMILIA" msprop:Generator_ColumnPropNameInRow="DESFAMILIA" msprop:Generator_ColumnPropNameInTable="DESFAMILIAColumn" msprop:Generator_UserColumnName="DESFAMILIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESLINEA" msprop:Generator_ColumnVarNameInTable="columnDESLINEA" msprop:Generator_ColumnPropNameInRow="DESLINEA" msprop:Generator_ColumnPropNameInTable="DESLINEAColumn" msprop:Generator_UserColumnName="DESLINEA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="STOCKACTUAL" msprop:Generator_ColumnVarNameInTable="columnSTOCKACTUAL" msprop:Generator_ColumnPropNameInRow="STOCKACTUAL" msprop:Generator_ColumnPropNameInTable="STOCKACTUALColumn" msprop:Generator_UserColumnName="STOCKACTUAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESSUCURSAL" msprop:Generator_ColumnVarNameInTable="columnDESSUCURSAL" msprop:Generator_ColumnPropNameInRow="DESSUCURSAL" msprop:Generator_ColumnPropNameInTable="DESSUCURSALColumn" msprop:Generator_UserColumnName="DESSUCURSAL" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESRUBRO" msprop:Generator_ColumnVarNameInTable="columnDESRUBRO" msprop:Generator_ColumnPropNameInRow="DESRUBRO" msprop:Generator_ColumnPropNameInTable="DESRUBROColumn" msprop:Generator_UserColumnName="DESRUBRO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PRODUCTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRODUCTO" msprop:Generator_ColumnPropNameInRow="PRODUCTO" msprop:Generator_ColumnPropNameInTable="PRODUCTOColumn" msprop:Generator_UserColumnName="PRODUCTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="181" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODCODIGO" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnCODCODIGO" msprop:Generator_ColumnPropNameInRow="CODCODIGO" msprop:Generator_ColumnPropNameInTable="CODCODIGOColumn" msprop:Generator_UserColumnName="CODCODIGO" type="xs:int" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RIStockMinimo" msprop:Generator_TableClassName="RIStockMinimoDataTable" msprop:Generator_TableVarName="tableRIStockMinimo" msprop:Generator_RowChangedName="RIStockMinimoRowChanged" msprop:Generator_TablePropName="RIStockMinimo" msprop:Generator_RowDeletingName="RIStockMinimoRowDeleting" msprop:Generator_RowChangingName="RIStockMinimoRowChanging" msprop:Generator_RowEvHandlerName="RIStockMinimoRowChangeEventHandler" msprop:Generator_RowDeletedName="RIStockMinimoRowDeleted" msprop:Generator_RowClassName="RIStockMinimoRow" msprop:Generator_UserTableName="RIStockMinimo" msprop:Generator_RowEvArgName="RIStockMinimoRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="PRODUCTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRODUCTO" msprop:Generator_ColumnPropNameInRow="PRODUCTO" msprop:Generator_ColumnPropNameInTable="PRODUCTOColumn" msprop:Generator_UserColumnName="PRODUCTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CATEGORIA" msprop:Generator_ColumnVarNameInTable="columnCATEGORIA" msprop:Generator_ColumnPropNameInRow="CATEGORIA" msprop:Generator_ColumnPropNameInTable="CATEGORIAColumn" msprop:Generator_UserColumnName="CATEGORIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="LINEA" msprop:Generator_ColumnVarNameInTable="columnLINEA" msprop:Generator_ColumnPropNameInRow="LINEA" msprop:Generator_ColumnPropNameInTable="LINEAColumn" msprop:Generator_UserColumnName="LINEA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MARCA" msprop:Generator_ColumnVarNameInTable="columnMARCA" msprop:Generator_ColumnPropNameInRow="MARCA" msprop:Generator_ColumnPropNameInTable="MARCAColumn" msprop:Generator_UserColumnName="MARCA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="STOCKMINIMO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSTOCKMINIMO" msprop:Generator_ColumnPropNameInRow="STOCKMINIMO" msprop:Generator_ColumnPropNameInTable="STOCKMINIMOColumn" msprop:Generator_UserColumnName="STOCKMINIMO" type="xs:decimal" minOccurs="0" />
              <xs:element name="STOCKMAXIMO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSTOCKMAXIMO" msprop:Generator_ColumnPropNameInRow="STOCKMAXIMO" msprop:Generator_ColumnPropNameInTable="STOCKMAXIMOColumn" msprop:Generator_UserColumnName="STOCKMAXIMO" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODCODIGO" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnCODCODIGO" msprop:Generator_ColumnPropNameInRow="CODCODIGO" msprop:Generator_ColumnPropNameInTable="CODCODIGOColumn" msprop:Generator_UserColumnName="CODCODIGO" type="xs:int" minOccurs="0" />
              <xs:element name="CODPRODUCTO" msprop:Generator_ColumnVarNameInTable="columnCODPRODUCTO" msprop:Generator_ColumnPropNameInRow="CODPRODUCTO" msprop:Generator_ColumnPropNameInTable="CODPRODUCTOColumn" msprop:Generator_UserColumnName="CODPRODUCTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="STOCKACTUAL" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnSTOCKACTUAL" msprop:Generator_ColumnPropNameInRow="STOCKACTUAL" msprop:Generator_ColumnPropNameInTable="STOCKACTUALColumn" msprop:Generator_UserColumnName="STOCKACTUAL" type="xs:decimal" minOccurs="0" />
              <xs:element name="MEDIDA" msprop:Generator_ColumnVarNameInTable="columnMEDIDA" msprop:Generator_ColumnPropNameInRow="MEDIDA" msprop:Generator_ColumnPropNameInTable="MEDIDAColumn" msprop:Generator_UserColumnName="MEDIDA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESSUCURSAL" msprop:Generator_ColumnVarNameInTable="columnDESSUCURSAL" msprop:Generator_ColumnPropNameInRow="DESSUCURSAL" msprop:Generator_ColumnPropNameInTable="DESSUCURSALColumn" msprop:Generator_UserColumnName="DESSUCURSAL" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODPRODUCTO1" msdata:Caption="CODPRODUCTO" msprop:Generator_ColumnVarNameInTable="columnCODPRODUCTO1" msprop:Generator_ColumnPropNameInRow="CODPRODUCTO1" msprop:Generator_ColumnPropNameInTable="CODPRODUCTO1Column" msprop:Generator_UserColumnName="CODPRODUCTO1" type="xs:int" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RIOrdenPorCategoria" msprop:Generator_TableClassName="RIOrdenPorCategoriaDataTable" msprop:Generator_TableVarName="tableRIOrdenPorCategoria" msprop:Generator_RowChangedName="RIOrdenPorCategoriaRowChanged" msprop:Generator_TablePropName="RIOrdenPorCategoria" msprop:Generator_RowDeletingName="RIOrdenPorCategoriaRowDeleting" msprop:Generator_RowChangingName="RIOrdenPorCategoriaRowChanging" msprop:Generator_RowEvHandlerName="RIOrdenPorCategoriaRowChangeEventHandler" msprop:Generator_RowDeletedName="RIOrdenPorCategoriaRowDeleted" msprop:Generator_RowClassName="RIOrdenPorCategoriaRow" msprop:Generator_UserTableName="RIOrdenPorCategoria" msprop:Generator_RowEvArgName="RIOrdenPorCategoriaRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="PRODUCTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRODUCTO" msprop:Generator_ColumnPropNameInRow="PRODUCTO" msprop:Generator_ColumnPropNameInTable="PRODUCTOColumn" msprop:Generator_UserColumnName="PRODUCTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CATEGORIA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCATEGORIA" msprop:Generator_ColumnPropNameInRow="CATEGORIA" msprop:Generator_ColumnPropNameInTable="CATEGORIAColumn" msprop:Generator_UserColumnName="CATEGORIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="LINEA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnLINEA" msprop:Generator_ColumnPropNameInRow="LINEA" msprop:Generator_ColumnPropNameInTable="LINEAColumn" msprop:Generator_UserColumnName="LINEA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MARCA" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnMARCA" msprop:Generator_ColumnPropNameInRow="MARCA" msprop:Generator_ColumnPropNameInTable="MARCAColumn" msprop:Generator_UserColumnName="MARCA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="MEDIDA" msprop:Generator_ColumnVarNameInTable="columnMEDIDA" msprop:Generator_ColumnPropNameInRow="MEDIDA" msprop:Generator_ColumnPropNameInTable="MEDIDAColumn" msprop:Generator_UserColumnName="MEDIDA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SERVICIO" msprop:Generator_ColumnVarNameInTable="columnSERVICIO" msprop:Generator_ColumnPropNameInRow="SERVICIO" msprop:Generator_ColumnPropNameInTable="SERVICIOColumn" msprop:Generator_UserColumnName="SERVICIO" type="xs:unsignedByte" minOccurs="0" />
              <xs:element name="DESSUCURSAL" msprop:Generator_ColumnVarNameInTable="columnDESSUCURSAL" msprop:Generator_ColumnPropNameInRow="DESSUCURSAL" msprop:Generator_ColumnPropNameInTable="DESSUCURSALColumn" msprop:Generator_UserColumnName="DESSUCURSAL" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RICostoPromedio" msprop:Generator_TableClassName="RICostoPromedioDataTable" msprop:Generator_TableVarName="tableRICostoPromedio" msprop:Generator_RowChangedName="RICostoPromedioRowChanged" msprop:Generator_TablePropName="RICostoPromedio" msprop:Generator_RowDeletingName="RICostoPromedioRowDeleting" msprop:Generator_RowChangingName="RICostoPromedioRowChanging" msprop:Generator_RowEvHandlerName="RICostoPromedioRowChangeEventHandler" msprop:Generator_RowDeletedName="RICostoPromedioRowDeleted" msprop:Generator_RowClassName="RICostoPromedioRow" msprop:Generator_UserTableName="RICostoPromedio" msprop:Generator_RowEvArgName="RICostoPromedioRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="DESFAMILIA" msprop:Generator_ColumnVarNameInTable="columnDESFAMILIA" msprop:Generator_ColumnPropNameInRow="DESFAMILIA" msprop:Generator_ColumnPropNameInTable="DESFAMILIAColumn" msprop:Generator_UserColumnName="DESFAMILIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESLINEA" msprop:Generator_ColumnVarNameInTable="columnDESLINEA" msprop:Generator_ColumnPropNameInRow="DESLINEA" msprop:Generator_ColumnPropNameInTable="DESLINEAColumn" msprop:Generator_UserColumnName="DESLINEA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESRUBRO" msprop:Generator_ColumnVarNameInTable="columnDESRUBRO" msprop:Generator_ColumnPropNameInRow="DESRUBRO" msprop:Generator_ColumnPropNameInTable="DESRUBROColumn" msprop:Generator_UserColumnName="DESRUBRO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESMEDIDA" msprop:Generator_ColumnVarNameInTable="columnDESMEDIDA" msprop:Generator_ColumnPropNameInRow="DESMEDIDA" msprop:Generator_ColumnPropNameInTable="DESMEDIDAColumn" msprop:Generator_UserColumnName="DESMEDIDA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESSUCURSAL" msprop:Generator_ColumnVarNameInTable="columnDESSUCURSAL" msprop:Generator_ColumnPropNameInRow="DESSUCURSAL" msprop:Generator_ColumnPropNameInTable="DESSUCURSALColumn" msprop:Generator_UserColumnName="DESSUCURSAL" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PRODUCTO" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnPRODUCTO" msprop:Generator_ColumnPropNameInRow="PRODUCTO" msprop:Generator_ColumnPropNameInTable="PRODUCTOColumn" msprop:Generator_UserColumnName="PRODUCTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="181" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="Cantidad" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnCantidad" msprop:Generator_ColumnPropNameInRow="Cantidad" msprop:Generator_ColumnPropNameInTable="CantidadColumn" msprop:Generator_UserColumnName="Cantidad" type="xs:decimal" minOccurs="0" />
              <xs:element name="TotalUni" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnTotalUni" msprop:Generator_ColumnPropNameInRow="TotalUni" msprop:Generator_ColumnPropNameInTable="TotalUniColumn" msprop:Generator_UserColumnName="TotalUni" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RIPrecio" msprop:Generator_TableClassName="RIPrecioDataTable" msprop:Generator_TableVarName="tableRIPrecio" msprop:Generator_RowChangedName="RIPrecioRowChanged" msprop:Generator_TablePropName="RIPrecio" msprop:Generator_RowDeletingName="RIPrecioRowDeleting" msprop:Generator_RowChangingName="RIPrecioRowChanging" msprop:Generator_RowEvHandlerName="RIPrecioRowChangeEventHandler" msprop:Generator_RowDeletedName="RIPrecioRowDeleted" msprop:Generator_RowClassName="RIPrecioRow" msprop:Generator_UserTableName="RIPrecio" msprop:Generator_RowEvArgName="RIPrecioRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="PRECIOVENTA" msprop:Generator_ColumnVarNameInTable="columnPRECIOVENTA" msprop:Generator_ColumnPropNameInRow="PRECIOVENTA" msprop:Generator_ColumnPropNameInTable="PRECIOVENTAColumn" msprop:Generator_UserColumnName="PRECIOVENTA" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODTIPOCLIENTE" msprop:Generator_ColumnVarNameInTable="columnCODTIPOCLIENTE" msprop:Generator_ColumnPropNameInRow="CODTIPOCLIENTE" msprop:Generator_ColumnPropNameInTable="CODTIPOCLIENTEColumn" msprop:Generator_UserColumnName="CODTIPOCLIENTE" type="xs:int" minOccurs="0" />
              <xs:element name="DESTIPOCLIENTE" msprop:Generator_ColumnVarNameInTable="columnDESTIPOCLIENTE" msprop:Generator_ColumnPropNameInRow="DESTIPOCLIENTE" msprop:Generator_ColumnPropNameInTable="DESTIPOCLIENTEColumn" msprop:Generator_UserColumnName="DESTIPOCLIENTE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RIStockDeposito" msprop:Generator_TableClassName="RIStockDepositoDataTable" msprop:Generator_TableVarName="tableRIStockDeposito" msprop:Generator_RowChangedName="RIStockDepositoRowChanged" msprop:Generator_TablePropName="RIStockDeposito" msprop:Generator_RowDeletingName="RIStockDepositoRowDeleting" msprop:Generator_RowChangingName="RIStockDepositoRowChanging" msprop:Generator_RowEvHandlerName="RIStockDepositoRowChangeEventHandler" msprop:Generator_RowDeletedName="RIStockDepositoRowDeleted" msprop:Generator_RowClassName="RIStockDepositoRow" msprop:Generator_UserTableName="RIStockDeposito" msprop:Generator_RowEvArgName="RIStockDepositoRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="Expr1" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnExpr1" msprop:Generator_ColumnPropNameInRow="Expr1" msprop:Generator_ColumnPropNameInTable="Expr1Column" msprop:Generator_UserColumnName="Expr1" type="xs:decimal" minOccurs="0" />
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="RIListadoCosto" msprop:Generator_TableClassName="RIListadoCostoDataTable" msprop:Generator_TableVarName="tableRIListadoCosto" msprop:Generator_RowChangedName="RIListadoCostoRowChanged" msprop:Generator_TablePropName="RIListadoCosto" msprop:Generator_RowDeletingName="RIListadoCostoRowDeleting" msprop:Generator_RowChangingName="RIListadoCostoRowChanging" msprop:Generator_RowEvHandlerName="RIListadoCostoRowChangeEventHandler" msprop:Generator_RowDeletedName="RIListadoCostoRowDeleted" msprop:Generator_RowClassName="RIListadoCostoRow" msprop:Generator_UserTableName="RIListadoCosto" msprop:Generator_RowEvArgName="RIListadoCostoRowChangeEvent">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="CODCODIGO" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_ColumnVarNameInTable="columnCODCODIGO" msprop:Generator_ColumnPropNameInRow="CODCODIGO" msprop:Generator_ColumnPropNameInTable="CODCODIGOColumn" msprop:Generator_UserColumnName="CODCODIGO" type="xs:int" />
              <xs:element name="CODIGO" msprop:Generator_ColumnVarNameInTable="columnCODIGO" msprop:Generator_ColumnPropNameInRow="CODIGO" msprop:Generator_ColumnPropNameInTable="CODIGOColumn" msprop:Generator_UserColumnName="CODIGO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="150" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESPRODUCTO" msprop:Generator_ColumnVarNameInTable="columnDESPRODUCTO" msprop:Generator_ColumnPropNameInRow="DESPRODUCTO" msprop:Generator_ColumnPropNameInTable="DESPRODUCTOColumn" msprop:Generator_UserColumnName="DESPRODUCTO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="80" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="COSTO" msprop:Generator_ColumnVarNameInTable="columnCOSTO" msprop:Generator_ColumnPropNameInRow="COSTO" msprop:Generator_ColumnPropNameInTable="COSTOColumn" msprop:Generator_UserColumnName="COSTO" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESFAMILIA" msprop:Generator_ColumnVarNameInTable="columnDESFAMILIA" msprop:Generator_ColumnPropNameInRow="DESFAMILIA" msprop:Generator_ColumnPropNameInTable="DESFAMILIAColumn" msprop:Generator_UserColumnName="DESFAMILIA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESLINEA" msprop:Generator_ColumnVarNameInTable="columnDESLINEA" msprop:Generator_ColumnPropNameInRow="DESLINEA" msprop:Generator_ColumnPropNameInTable="DESLINEAColumn" msprop:Generator_UserColumnName="DESLINEA" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESRUBRO" msprop:Generator_ColumnVarNameInTable="columnDESRUBRO" msprop:Generator_ColumnPropNameInRow="DESRUBRO" msprop:Generator_ColumnPropNameInTable="DESRUBROColumn" msprop:Generator_UserColumnName="DESRUBRO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
    <xs:unique name="Constraint1" msdata:PrimaryKey="true">
      <xs:selector xpath=".//mstns:RIStockActual" />
      <xs:field xpath="mstns:CODCODIGO" />
    </xs:unique>
    <xs:unique name="RIStockMinimo_Constraint1" msdata:ConstraintName="Constraint1">
      <xs:selector xpath=".//mstns:RIStockMinimo" />
      <xs:field xpath="mstns:CODCODIGO" />
    </xs:unique>
    <xs:unique name="RIListadoCosto_Constraint1" msdata:ConstraintName="Constraint1" msdata:PrimaryKey="true">
      <xs:selector xpath=".//mstns:RIListadoCosto" />
      <xs:field xpath="mstns:CODCODIGO" />
    </xs:unique>
  </xs:element>
</xs:schema>